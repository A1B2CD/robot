<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="22,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T2U3">c</span>,<span class="var type1" id="S3T2U4">d</span>,<span class="var type1" id="S4T2U5">g</span>,<span class="var type1" id="S5T25U6">D</span>,<span class="var type1" id="S6T15U7">dm</span>] = comp_cdg_adaptiv(<span class="var type1" id="S7T24U10">J</span>,<span class="var type1" id="S8T23U11">R</span>,<span class="var type1" id="S9T20U12">theta</span>,<span class="var type2" id="S10T5V1U13">snake</span>,<span class="var type1" id="S11T16U14">pp</span>,<span class="var type1" id="S12T8U15">beta</span>,<span class="var type1" id="S13T8U16">gamma</span>,<span class="var type1" id="S14T2U17">zeta1</span>,<span class="var type1" id="S15T4U18">zeta_r</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="22,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%This function computes the terms c=C(theta,zeta1)zeta2,</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%d=D(theta,zeta1)zeta2, and g(eta,theta), i.e. the coriolis, drag and</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%hydrostatic forces on the snake. The sign-convention is such that these</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%enter the equation of motion on the left-hand side, i.e. the actual force</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%in terms of newton's laws is what this script puts out times -1.</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T36:U15"><span class="var type1" id="S16T36U21">dragcoeff_for_comparison</span> = <span class="mxinfo " id="T36:U17">[<span class="mxinfo " id="T8:U18">0.2</span>, <span class="mxinfo " id="T8:U19">0.1</span>, <span class="mxinfo " id="T8:U20">0.8</span>, <span class="mxinfo " id="T8:U21">0.1</span>, <span class="var type1" id="S12T8U28">beta</span>, <span class="var type1" id="S13T8U29">gamma</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% dragcoeff_for_comparison = [0.5, 0.5, 0.5, 0.5, beta, gamma];</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T15:U24"><span class="var type1" id="S17T15U32">nu1</span> = <span class="mxinfo " id="T15:U26"><span class="var type1" id="S14T2U34">zeta1</span>(<span class="mxinfo " id="T55:U28">1:6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T15:U29"><span class="var type1" id="S18T15U40">nu2</span>=<span class="mxinfo " id="T15:U31"><span class="var type1" id="S15T4U42">zeta_r</span>(<span class="mxinfo " id="T55:U33">1:6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo " id="T8:U34"><span class="var type1" id="S19T8U48">slices</span> = <span class="mxinfo " id="T8:U36">10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T6:U37"><span class="var type1" id="S20T6U52">x</span>   = <span class="mxinfo " id="T6:U39">linspace(0,1,<span class="var type1" id="S19T8U57">slices</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T8:U41"><span class="var type1" id="S22T8U60">dx</span>  = <span class="mxinfo " id="T8:U43"><span class="mxinfo " id="T8:U44"><span class="var type1" id="S20T6U63">x</span>(<span class="mxinfo " id="T8:U46">2</span>)</span>-<span class="mxinfo " id="T8:U47"><span class="var type1" id="S20T6U66">x</span>(<span class="mxinfo " id="T8:U49">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T6:U50"><span class="var type1" id="S23T6U70">sqrtx</span>   =  <span class="mxinfo " id="T6:U52">sqrt(<span class="mxinfo " id="T6:U53"><span class="mxinfo " id="T6:U54"><span class="mxinfo " id="T6:U55"><span class="mxinfo " id="T6:U56"><span class="mxinfo " id="T8:U57"><span class="mxinfo " id="T8:U58"><span class="mxinfo " id="T8:U59"><span class="var type1" id="S17T15U80">nu1</span>(<span class="mxinfo " id="T45:U61">2</span>)</span>^2</span>+<span class="mxinfo " id="T8:U62"><span class="mxinfo " id="T8:U63"><span class="var type1" id="S17T15U85">nu1</span>(<span class="mxinfo " id="T45:U65">3</span>)</span>^2</span></span>+<span class="mxinfo " id="T6:U66"><span class="mxinfo " id="T6:U67"><span class="var type1" id="S20T6U90">x</span>.^2</span>*<span class="mxinfo " id="T8:U69"><span class="mxinfo " id="T8:U70"><span class="var type1" id="S17T15U94">nu1</span>(<span class="mxinfo " id="T45:U72">5</span>)</span>^2</span></span></span>+<span class="mxinfo " id="T6:U73"><span class="mxinfo " id="T6:U74"><span class="var type1" id="S20T6U99">x</span>.^2</span>*<span class="mxinfo " id="T8:U76"><span class="mxinfo " id="T8:U77"><span class="var type1" id="S17T15U103">nu1</span>(<span class="mxinfo " id="T45:U79">6</span>)</span>^2</span></span></span>+<span class="mxinfo " id="T6:U80"><span class="mxinfo " id="T6:U81"><span class="mxinfo " id="T6:U82">2*<span class="var type1" id="S20T6U110">x</span></span>*<span class="mxinfo " id="T8:U84"><span class="var type1" id="S17T15U112">nu1</span>(<span class="mxinfo " id="T45:U86">2</span>)</span></span>*<span class="mxinfo " id="T8:U87"><span class="var type1" id="S17T15U115">nu1</span>(<span class="mxinfo " id="T45:U89">6</span>)</span></span></span>-<span class="mxinfo " id="T6:U90"><span class="mxinfo " id="T6:U91"><span class="mxinfo " id="T6:U92">2*<span class="var type1" id="S20T6U121">x</span></span>*<span class="mxinfo " id="T8:U94"><span class="var type1" id="S17T15U123">nu1</span>(<span class="mxinfo " id="T45:U96">3</span>)</span></span>*<span class="mxinfo " id="T8:U97"><span class="var type1" id="S17T15U126">nu1</span>(<span class="mxinfo " id="T45:U99">5</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,15" id="srcline15">15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T8:U100"><span class="var type1" id="S25T8U130">v_ref</span> = <span class="mxinfo " id="T8:U102">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T25:U103"><span class="var type1" id="S5T25U134">D</span>=<span class="mxinfo " id="T25:U105">zeros(<span class="mxinfo " id="T8:U106">6</span>,<span class="mxinfo " id="T8:U107">4</span>,<span class="mxinfo " id="T8:U108"><span class="var type1" id="S10T5U140">snake</span>.n</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,19" id="srcline19">19</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T8:U110"><span class="var type1" id="S27T8U144">rho</span>=<span class="mxinfo " id="T8:U112"><span class="var type1" id="S11T16U146">pp</span>.denw</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T15:U114"><span class="var type1" id="S6T15U150">dm</span>=<span class="mxinfo " id="T15:U116"><span class="mxinfo " id="T36:U117">[<span class="mxinfo " id="T8:U118">0</span> <span class="mxinfo " id="T8:U119">0</span> <span class="mxinfo " id="T8:U120">0</span> <span class="mxinfo " id="T8:U121">0</span> <span class="mxinfo " id="T8:U122">0</span> <span class="mxinfo " id="T8:U123">0</span>]</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,23" id="srcline23">23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T2:U124"><span class="var type1" id="S2T2U162">c</span>  = <span class="mxinfo " id="T2:U126"><span class="mxinfo " id="T28:U127"><span class="mxinfo " id="T28:U128">-<span class="mxinfo " id="T28:U129"><span class="mxinfo " id="T29:U130"><span class="var type1" id="S7T24U168">J</span>(<span class="mxinfo " id="T30:U132">:</span>,<span class="mxinfo " id="T31:U133">:</span>,<span class="mxinfo " id="T45:U134">1</span>)</span>'</span></span>*<span class="mxinfo " id="T11:U135"><span class="fcn" id="F102N7:B173">W</span>(<span class="mxinfo " id="T15:U136"><span class="mxinfo " id="T11:U137"><span class="var type1" id="S10T5U178">snake</span>.link(1).M</span>*<span class="var type1" id="S17T15U182">nu1</span></span>)</span></span>*<span class="var type1" id="S18T15U183">nu2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T15:U141"><span class="var type1" id="S29T15U186">xi</span> = <span class="mxinfo " id="T15:U143">zeros(<span class="mxinfo " id="T8:U144">6</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,26" id="srcline26">26</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S10T5U197">snake</span>.link(1).dragtype==1</span></span>
<span class="srcline"><span class="lineno"><a href="22,27" id="srcline27">27</a></span><span class="line">        <span class="var type0" id="S3T0U204">d</span>  = <span class="var type0" id="S7T0U208">J</span>(:,:,1)'*zeros(6,1);</span></span>
<span class="srcline"><span class="lineno"><a href="22,28" id="srcline28">28</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,29" id="srcline29">29</a></span><span class="line">        <span class="mxinfo " id="T2:U146"><span class="var type1" id="S3T2U219">d</span>  = <span class="mxinfo " id="T2:U148"><span class="mxinfo " id="T28:U149"><span class="mxinfo " id="T29:U150"><span class="var type1" id="S7T24U223">J</span>(<span class="mxinfo " id="T30:U152">:</span>,<span class="mxinfo " id="T31:U153">:</span>,<span class="mxinfo " id="T45:U154">1</span>)</span>'</span>*<span class="mxinfo " id="T15:U155"><span class="fcn" id="F110N12:B228">drag</span>(<span class="var type1" id="S17T15U229">nu1</span>,<span class="var type1" id="S18T15U230">nu2</span>,<span class="mxinfo " id="T8:U158"><span class="var type1" id="S10T5U234">snake</span>.link(1).length</span>,<span class="mxinfo " id="T8:U160"><span class="var type1" id="S11T16U239">pp</span>.denw</span>,<span class="mxinfo " id="T8:U162"><span class="var type1" id="S10T5U242">snake</span>.r</span>,<span class="var type1" id="S16T36U244">dragcoeff_for_comparison</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,30" id="srcline30">30</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,31" id="srcline31">31</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="22,32" id="srcline32">32</a></span><span class="line">            <span class="mxinfo " id="T8:U165"><span class="mxinfo " id="T8:U166"><span class="var type1" id="S5T25U248">D</span>(<span class="mxinfo " id="T8:U168">1</span>,<span class="mxinfo " id="T8:U169">1</span>,<span class="mxinfo " id="T8:U170">1</span>)</span>=<span class="mxinfo " id="T8:U171"><span class="mxinfo " id="T8:U172"><span class="mxinfo " id="T8:U173"><span class="mxinfo " id="T8:U174"><span class="mxinfo " id="T8:U175"><span class="mxinfo " id="T8:U176">.5</span>*<span class="var type1" id="S27T8U258">rho</span></span>*<span class="mxinfo " id="T8:U178">pi</span></span>*<span class="mxinfo " id="T8:U179"><span class="mxinfo " id="T8:U180"><span class="var type1" id="S10T5U263">snake</span>.r</span>^2</span></span>*<span class="mxinfo " id="T8:U182">abs(<span class="mxinfo " id="T8:U183"><span class="var type1" id="S17T15U269">nu1</span>(<span class="mxinfo " id="T45:U185">1</span>)</span>)</span></span>*<span class="mxinfo " id="T8:U186"><span class="var type1" id="S18T15U272">nu2</span>(<span class="mxinfo " id="T8:U188">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,33" id="srcline33">33</a></span><span class="line">            <span class="mxinfo " id="T8:U189"><span class="mxinfo " id="T8:U190"><span class="var type1" id="S5T25U277">D</span>(<span class="mxinfo " id="T8:U192">1</span>,<span class="mxinfo " id="T8:U193">4</span>,<span class="mxinfo " id="T8:U194">1</span>)</span>=<span class="mxinfo " id="T8:U195"><span class="mxinfo " id="T8:U196"><span class="mxinfo " id="T8:U197"><span class="mxinfo " id="T8:U198"><span class="mxinfo " id="T8:U199"><span class="var type1" id="S27T8U286">rho</span>*<span class="mxinfo " id="T8:U201"><span class="var type1" id="S10T5U288">snake</span>.r</span></span>*<span class="mxinfo " id="T8:U203"><span class="mxinfo " id="T43:U204"><span class="mxinfo " id="T9:U205"><span class="var type1" id="S10T5U293">snake</span>.link</span>(<span class="mxinfo " id="T8:U207">1</span>)</span>.length</span></span>*<span class="var type1" id="S25T8U297">v_ref</span></span>*<span class="var type1" id="S12T8U298">beta</span></span>*<span class="mxinfo " id="T8:U210"><span class="var type1" id="S18T15U300">nu2</span>(<span class="mxinfo " id="T8:U212">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,34" id="srcline34">34</a></span><span class="line">            <span class="mxinfo " id="T8:U213"><span class="mxinfo " id="T8:U214"><span class="var type1" id="S5T25U305">D</span>(<span class="mxinfo " id="T8:U216">2</span>,<span class="mxinfo " id="T8:U217">3</span>,<span class="mxinfo " id="T8:U218">1</span>)</span>=<span class="mxinfo " id="T8:U219"><span class="mxinfo " id="T8:U220"><span class="mxinfo " id="T8:U221"><span class="mxinfo " id="T8:U222"><span class="var type1" id="S27T8U313">rho</span>*<span class="mxinfo " id="T8:U224"><span class="var type1" id="S10T5U315">snake</span>.r</span></span>*<span class="var type1" id="S22T8U317">dx</span></span>*<span class="mxinfo " id="T8:U227"><span class="mxinfo " id="T43:U228"><span class="mxinfo " id="T9:U229"><span class="var type1" id="S10T5U321">snake</span>.link</span>(<span class="mxinfo " id="T8:U231">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U232">trapz(<span class="mxinfo " id="T6:U233"><span class="var type1" id="S23T6U328">sqrtx</span>.*(<span class="mxinfo " id="T6:U235"><span class="mxinfo " id="T8:U236"><span class="var type1" id="S18T15U332">nu2</span>(<span class="mxinfo " id="T8:U238">2</span>)</span>+<span class="mxinfo " id="T6:U239"><span class="mxinfo " id="T8:U240"><span class="var type1" id="S18T15U336">nu2</span>(<span class="mxinfo " id="T45:U242">6</span>)</span>*<span class="var type1" id="S20T6U338">x</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,35" id="srcline35">35</a></span><span class="line">            <span class="mxinfo " id="T8:U244"><span class="mxinfo " id="T8:U245"><span class="var type1" id="S5T25U342">D</span>(<span class="mxinfo " id="T8:U247">2</span>,<span class="mxinfo " id="T8:U248">4</span>,<span class="mxinfo " id="T8:U249">1</span>)</span>=<span class="mxinfo " id="T8:U250"><span class="mxinfo " id="T8:U251"><span class="mxinfo " id="T8:U252"><span class="mxinfo " id="T8:U253"><span class="var type1" id="S27T8U350">rho</span>*<span class="mxinfo " id="T8:U255"><span class="var type1" id="S10T5U352">snake</span>.r</span></span>*<span class="mxinfo " id="T8:U257"><span class="mxinfo " id="T43:U258"><span class="mxinfo " id="T9:U259"><span class="var type1" id="S10T5U357">snake</span>.link</span>(<span class="mxinfo " id="T8:U261">1</span>)</span>.length</span></span>*<span class="var type1" id="S25T8U361">v_ref</span></span>*(<span class="mxinfo " id="T8:U263"><span class="mxinfo " id="T8:U264"><span class="var type1" id="S18T15U365">nu2</span>(<span class="mxinfo " id="T8:U266">2</span>)</span>+<span class="mxinfo " id="T8:U267"><span class="mxinfo " id="T8:U268"><span class="mxinfo " id="T8:U269">0.5</span>*<span class="mxinfo " id="T8:U270"><span class="mxinfo " id="T43:U271"><span class="mxinfo " id="T9:U272"><span class="var type1" id="S10T5U373">snake</span>.link</span>(<span class="mxinfo " id="T8:U274">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U275"><span class="var type1" id="S18T15U378">nu2</span>(<span class="mxinfo " id="T8:U277">6</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,36" id="srcline36">36</a></span><span class="line">            <span class="mxinfo " id="T8:U278"><span class="mxinfo " id="T8:U279"><span class="var type1" id="S5T25U383">D</span>(<span class="mxinfo " id="T8:U281">3</span>,<span class="mxinfo " id="T8:U282">3</span>,<span class="mxinfo " id="T8:U283">1</span>)</span>=<span class="mxinfo " id="T8:U284"><span class="mxinfo " id="T8:U285"><span class="mxinfo " id="T8:U286"><span class="mxinfo " id="T8:U287"><span class="var type1" id="S27T8U391">rho</span>*<span class="mxinfo " id="T8:U289"><span class="var type1" id="S10T5U393">snake</span>.r</span></span>*<span class="var type1" id="S22T8U395">dx</span></span>*<span class="mxinfo " id="T8:U292"><span class="mxinfo " id="T43:U293"><span class="mxinfo " id="T9:U294"><span class="var type1" id="S10T5U399">snake</span>.link</span>(<span class="mxinfo " id="T8:U296">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U297">trapz(<span class="mxinfo " id="T6:U298"><span class="var type1" id="S23T6U406">sqrtx</span>.*(<span class="mxinfo " id="T6:U300"><span class="mxinfo " id="T8:U301"><span class="var type1" id="S18T15U410">nu2</span>(<span class="mxinfo " id="T8:U303">3</span>)</span>-<span class="mxinfo " id="T6:U304"><span class="mxinfo " id="T8:U305"><span class="var type1" id="S18T15U414">nu2</span>(<span class="mxinfo " id="T45:U307">5</span>)</span>*<span class="var type1" id="S20T6U416">x</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,37" id="srcline37">37</a></span><span class="line">            <span class="mxinfo " id="T8:U309"><span class="mxinfo " id="T8:U310"><span class="var type1" id="S5T25U420">D</span>(<span class="mxinfo " id="T8:U312">3</span>,<span class="mxinfo " id="T8:U313">4</span>,<span class="mxinfo " id="T8:U314">1</span>)</span>=<span class="mxinfo " id="T8:U315"><span class="mxinfo " id="T8:U316"><span class="mxinfo " id="T8:U317"><span class="mxinfo " id="T8:U318"><span class="var type1" id="S27T8U428">rho</span>*<span class="mxinfo " id="T8:U320"><span class="var type1" id="S10T5U430">snake</span>.r</span></span>*<span class="mxinfo " id="T8:U322"><span class="mxinfo " id="T43:U323"><span class="mxinfo " id="T9:U324"><span class="var type1" id="S10T5U435">snake</span>.link</span>(<span class="mxinfo " id="T8:U326">1</span>)</span>.length</span></span>*<span class="var type1" id="S25T8U439">v_ref</span></span>*(<span class="mxinfo " id="T8:U328"><span class="mxinfo " id="T8:U329"><span class="var type1" id="S18T15U443">nu2</span>(<span class="mxinfo " id="T8:U331">3</span>)</span>-<span class="mxinfo " id="T8:U332"><span class="mxinfo " id="T8:U333"><span class="mxinfo " id="T8:U334">0.5</span>*<span class="mxinfo " id="T8:U335"><span class="mxinfo " id="T43:U336"><span class="mxinfo " id="T9:U337"><span class="var type1" id="S10T5U451">snake</span>.link</span>(<span class="mxinfo " id="T8:U339">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U340"><span class="var type1" id="S18T15U456">nu2</span>(<span class="mxinfo " id="T8:U342">5</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,38" id="srcline38">38</a></span><span class="line">            <span class="mxinfo " id="T8:U343"><span class="mxinfo " id="T8:U344"><span class="var type1" id="S5T25U461">D</span>(<span class="mxinfo " id="T8:U346">4</span>,<span class="mxinfo " id="T8:U347">2</span>,<span class="mxinfo " id="T8:U348">1</span>)</span>=<span class="mxinfo " id="T8:U349"><span class="mxinfo " id="T8:U350"><span class="mxinfo " id="T8:U351"><span class="mxinfo " id="T8:U352"><span class="mxinfo " id="T8:U353"><span class="mxinfo " id="T8:U354"><span class="mxinfo " id="T8:U355">.5</span>*<span class="var type1" id="S27T8U472">rho</span></span>*<span class="mxinfo " id="T8:U357">pi</span></span>*<span class="mxinfo " id="T8:U358"><span class="mxinfo " id="T43:U359"><span class="mxinfo " id="T9:U360"><span class="var type1" id="S10T5U478">snake</span>.link</span>(<span class="mxinfo " id="T8:U362">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U363"><span class="mxinfo " id="T8:U364"><span class="var type1" id="S10T5U484">snake</span>.r</span>^4</span></span>*<span class="mxinfo " id="T8:U366">abs(<span class="mxinfo " id="T8:U367"><span class="var type1" id="S17T15U490">nu1</span>(<span class="mxinfo " id="T45:U369">4</span>)</span>)</span></span>*<span class="mxinfo " id="T8:U370"><span class="var type1" id="S18T15U493">nu2</span>(<span class="mxinfo " id="T8:U372">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,39" id="srcline39">39</a></span><span class="line">            <span class="mxinfo " id="T8:U373"><span class="mxinfo " id="T8:U374"><span class="var type1" id="S5T25U498">D</span>(<span class="mxinfo " id="T8:U376">4</span>,<span class="mxinfo " id="T8:U377">4</span>,<span class="mxinfo " id="T8:U378">1</span>)</span>=<span class="mxinfo " id="T8:U379"><span class="mxinfo " id="T8:U380"><span class="mxinfo " id="T8:U381"><span class="mxinfo " id="T8:U382"><span class="mxinfo " id="T8:U383"><span class="mxinfo " id="T8:U384"><span class="var type1" id="S27T8U508">rho</span>*<span class="mxinfo " id="T8:U386"><span class="var type1" id="S10T5U510">snake</span>.r</span></span>*<span class="mxinfo " id="T8:U388"><span class="mxinfo " id="T43:U389"><span class="mxinfo " id="T9:U390"><span class="var type1" id="S10T5U515">snake</span>.link</span>(<span class="mxinfo " id="T8:U392">1</span>)</span>.length</span></span>*<span class="var type1" id="S25T8U519">v_ref</span></span>*<span class="var type1" id="S13T8U520">gamma</span></span>*<span class="mxinfo " id="T8:U395"><span class="mxinfo " id="T8:U396"><span class="var type1" id="S10T5U523">snake</span>.r</span>^2</span></span>*<span class="mxinfo " id="T8:U398"><span class="var type1" id="S18T15U527">nu2</span>(<span class="mxinfo " id="T8:U400">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,40" id="srcline40">40</a></span><span class="line">            <span class="mxinfo " id="T8:U401"><span class="mxinfo " id="T8:U402"><span class="var type1" id="S5T25U532">D</span>(<span class="mxinfo " id="T8:U404">5</span>,<span class="mxinfo " id="T8:U405">3</span>,<span class="mxinfo " id="T8:U406">1</span>)</span>=<span class="mxinfo " id="T8:U407"><span class="mxinfo " id="T8:U408"><span class="mxinfo " id="T8:U409"><span class="mxinfo " id="T8:U410"><span class="var type1" id="S27T8U540">rho</span>*<span class="mxinfo " id="T8:U412"><span class="var type1" id="S10T5U542">snake</span>.r</span></span>*<span class="var type1" id="S22T8U544">dx</span></span>*<span class="mxinfo " id="T8:U415"><span class="mxinfo " id="T43:U416"><span class="mxinfo " id="T9:U417"><span class="var type1" id="S10T5U548">snake</span>.link</span>(<span class="mxinfo " id="T8:U419">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U420">trapz(<span class="mxinfo " id="T6:U421"><span class="var type1" id="S23T6U555">sqrtx</span>.*(<span class="mxinfo " id="T6:U423"><span class="mxinfo " id="T6:U424"><span class="mxinfo " id="T8:U425">-<span class="mxinfo " id="T8:U426"><span class="var type1" id="S18T15U561">nu2</span>(<span class="mxinfo " id="T45:U428">3</span>)</span></span>*<span class="var type1" id="S20T6U563">x</span></span>+<span class="mxinfo " id="T6:U430"><span class="mxinfo " id="T8:U431"><span class="var type1" id="S18T15U566">nu2</span>(<span class="mxinfo " id="T45:U433">5</span>)</span>*<span class="mxinfo " id="T6:U434"><span class="var type1" id="S20T6U569">x</span>.^2</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,41" id="srcline41">41</a></span><span class="line">            <span class="mxinfo " id="T8:U436"><span class="mxinfo " id="T8:U437"><span class="var type1" id="S5T25U574">D</span>(<span class="mxinfo " id="T8:U439">5</span>,<span class="mxinfo " id="T8:U440">4</span>,<span class="mxinfo " id="T8:U441">1</span>)</span>=<span class="mxinfo " id="T8:U442"><span class="mxinfo " id="T8:U443"><span class="mxinfo " id="T8:U444"><span class="mxinfo " id="T8:U445"><span class="var type1" id="S27T8U582">rho</span>*<span class="mxinfo " id="T8:U447"><span class="var type1" id="S10T5U584">snake</span>.r</span></span>*<span class="mxinfo " id="T8:U449"><span class="mxinfo " id="T43:U450"><span class="mxinfo " id="T9:U451"><span class="var type1" id="S10T5U589">snake</span>.link</span>(<span class="mxinfo " id="T8:U453">1</span>)</span>.length</span></span>*<span class="var type1" id="S25T8U593">v_ref</span></span>*(<span class="mxinfo " id="T8:U455"><span class="mxinfo " id="T8:U456"><span class="mxinfo " id="T8:U457"><span class="mxinfo " id="T8:U458">-<span class="mxinfo " id="T8:U459">0.5</span></span>*<span class="mxinfo " id="T8:U460"><span class="mxinfo " id="T43:U461"><span class="mxinfo " id="T9:U462"><span class="var type1" id="S10T5U603">snake</span>.link</span>(<span class="mxinfo " id="T8:U464">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U465"><span class="var type1" id="S18T15U608">nu2</span>(<span class="mxinfo " id="T8:U467">3</span>)</span></span>+<span class="mxinfo " id="T8:U468"><span class="mxinfo " id="T8:U469"><span class="mxinfo " id="T8:U470"><span class="mxinfo " id="T8:U471"><span class="var type1" id="S10T5U616">snake</span>.link(1).length</span>^2</span>*<span class="mxinfo " id="T8:U473"><span class="var type1" id="S18T15U622">nu2</span>(<span class="mxinfo " id="T45:U475">5</span>)</span></span>/<span class="mxinfo " id="T8:U476">3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,42" id="srcline42">42</a></span><span class="line">            <span class="mxinfo " id="T8:U477"><span class="mxinfo " id="T8:U478"><span class="var type1" id="S5T25U628">D</span>(<span class="mxinfo " id="T8:U480">6</span>,<span class="mxinfo " id="T8:U481">3</span>,<span class="mxinfo " id="T8:U482">1</span>)</span>=<span class="mxinfo " id="T8:U483"><span class="mxinfo " id="T8:U484"><span class="mxinfo " id="T8:U485"><span class="mxinfo " id="T8:U486"><span class="var type1" id="S27T8U636">rho</span>*<span class="mxinfo " id="T8:U488"><span class="var type1" id="S10T5U638">snake</span>.r</span></span>*<span class="var type1" id="S22T8U640">dx</span></span>*<span class="mxinfo " id="T8:U491"><span class="mxinfo " id="T43:U492"><span class="mxinfo " id="T9:U493"><span class="var type1" id="S10T5U644">snake</span>.link</span>(<span class="mxinfo " id="T8:U495">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U496">trapz(<span class="mxinfo " id="T6:U497"><span class="var type1" id="S23T6U651">sqrtx</span>.*(<span class="mxinfo " id="T6:U499"><span class="mxinfo " id="T6:U500"><span class="mxinfo " id="T8:U501"><span class="var type1" id="S18T15U656">nu2</span>(<span class="mxinfo " id="T45:U503">2</span>)</span>*<span class="var type1" id="S20T6U658">x</span></span>+<span class="mxinfo " id="T6:U505"><span class="mxinfo " id="T8:U506"><span class="var type1" id="S18T15U661">nu2</span>(<span class="mxinfo " id="T45:U508">6</span>)</span>*<span class="mxinfo " id="T6:U509"><span class="var type1" id="S20T6U664">x</span>.^2</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,43" id="srcline43">43</a></span><span class="line">            <span class="mxinfo " id="T8:U511"><span class="mxinfo " id="T8:U512"><span class="var type1" id="S5T25U669">D</span>(<span class="mxinfo " id="T8:U514">6</span>,<span class="mxinfo " id="T8:U515">4</span>,<span class="mxinfo " id="T8:U516">1</span>)</span>=<span class="mxinfo " id="T8:U517"><span class="mxinfo " id="T8:U518"><span class="mxinfo " id="T8:U519"><span class="mxinfo " id="T8:U520"><span class="var type1" id="S27T8U677">rho</span>*<span class="mxinfo " id="T8:U522"><span class="var type1" id="S10T5U679">snake</span>.r</span></span>*<span class="mxinfo " id="T8:U524"><span class="mxinfo " id="T43:U525"><span class="mxinfo " id="T9:U526"><span class="var type1" id="S10T5U684">snake</span>.link</span>(<span class="mxinfo " id="T8:U528">1</span>)</span>.length</span></span>*<span class="var type1" id="S25T8U688">v_ref</span></span>*(<span class="mxinfo " id="T8:U530"><span class="mxinfo " id="T8:U531"><span class="mxinfo " id="T8:U532"><span class="mxinfo " id="T8:U533">0.5</span>*<span class="mxinfo " id="T8:U534"><span class="mxinfo " id="T43:U535"><span class="mxinfo " id="T9:U536"><span class="var type1" id="S10T5U697">snake</span>.link</span>(<span class="mxinfo " id="T8:U538">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U539"><span class="var type1" id="S18T15U702">nu2</span>(<span class="mxinfo " id="T8:U541">2</span>)</span></span>+<span class="mxinfo " id="T8:U542"><span class="mxinfo " id="T8:U543"><span class="mxinfo " id="T8:U544"><span class="mxinfo " id="T8:U545"><span class="var type1" id="S10T5U710">snake</span>.link(1).length</span>^2</span>*<span class="mxinfo " id="T8:U547"><span class="var type1" id="S18T15U716">nu2</span>(<span class="mxinfo " id="T45:U549">6</span>)</span></span>/<span class="mxinfo " id="T8:U550">3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,44" id="srcline44">44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,45" id="srcline45">45</a></span><span class="line">    <span class="mxinfo " id="T2:U551"><span class="var type1" id="S4T2U721">g</span>  = <span class="mxinfo " id="T2:U553"><span class="mxinfo " id="T56:U554"><span class="mxinfo " id="T56:U555"><span class="mxinfo " id="T28:U556"><span class="mxinfo " id="T29:U557"><span class="var type1" id="S7T24U727">J</span>(<span class="mxinfo " id="T30:U559">:</span>,<span class="mxinfo " id="T31:U560">:</span>,<span class="mxinfo " id="T45:U561">1</span>)</span>'</span>*<span class="mxinfo " id="T12:U562"><span class="var type1" id="S10T5U734">snake</span>.link(1).G</span></span>*<span class="mxinfo " id="T34:U564"><span class="mxinfo " id="T34:U565"><span class="var type1" id="S8T23U740">R</span>(<span class="mxinfo " id="T35:U567">:</span>,<span class="mxinfo " id="T35:U568">:</span>,<span class="mxinfo " id="T45:U569">1</span>)</span>'</span></span>*<span class="mxinfo " id="T17:U570"><span class="var type1" id="S11T16U745">pp</span>.gdir</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,46" id="srcline46">46</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,47" id="srcline47">47</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,48" id="srcline48">48</a></span><span class="line"> <span class="keyword">for</span> <span class="var type1" id="S34T8U749">i</span>=<span class="mxinfo " id="T20:U573"><span class="mxinfo " id="T8:U574">2</span>:<span class="var type1" id="S10T5U753">snake</span>.n</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,49" id="srcline49">49</a></span><span class="line">     <span class="mxinfo " id="T8:U576"><span class="var type1" id="S35T8U757">j</span>=<span class="mxinfo " id="T8:U578"><span class="var type1" id="S34T8U759">i</span>-<span class="mxinfo " id="T8:U580">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,50" id="srcline50">50</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T37:U581"><span class="mxinfo " id="T8:U582"><span class="mxinfo " id="T38:U583"><span class="mxinfo " id="T14:U584"><span class="var type1" id="S10T5U767">snake</span>.joint</span>(<span class="var type1" id="S35T8U769">j</span>)</span>.type</span>==<span class="mxinfo " id="T8:U587">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="22,51" id="srcline51">51</a></span><span class="line">        <span class="mxinfo " id="T39:U588"><span class="var type1" id="S36T39U774">A</span>=<span class="mxinfo " id="T39:U590">[<span class="mxinfo " id="T40:U591"><span class="mxinfo " id="T34:U592"><span class="fcn" id="F21N4:B778">Rotx</span>(<span class="mxinfo " id="T8:U593"><span class="var type1" id="S9T20U780">theta</span>(<span class="var type1" id="S35T8U781">j</span>)</span>)</span>, <span class="mxinfo " id="T41:U596"><span class="mxinfo " id="T42:U597">[<span class="mxinfo " id="T8:U598"><span class="mxinfo " id="T43:U599"><span class="mxinfo " id="T9:U600"><span class="var type1" id="S10T5U788">snake</span>.link</span>(<span class="var type1" id="S34T8U790">i</span>)</span>.length</span> <span class="mxinfo " id="T8:U603">0</span> <span class="mxinfo " id="T8:U604">0</span>]</span>'</span></span>; <span class="mxinfo " id="T44:U605">[<span class="mxinfo " id="T8:U606">0</span> <span class="mxinfo " id="T8:U607">0</span> <span class="mxinfo " id="T8:U608">0</span> <span class="mxinfo " id="T8:U609">1</span>]</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,52" id="srcline52">52</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo " id="T37:U610"><span class="mxinfo " id="T8:U611"><span class="mxinfo " id="T38:U612"><span class="mxinfo " id="T14:U613"><span class="var type1" id="S10T5U806">snake</span>.joint</span>(<span class="var type1" id="S35T8U808">j</span>)</span>.type</span>==<span class="mxinfo " id="T8:U616">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="22,53" id="srcline53">53</a></span><span class="line">        <span class="mxinfo " id="T39:U617"><span class="var type1" id="S36T39U813">A</span>=<span class="mxinfo " id="T39:U619">[<span class="mxinfo " id="T40:U620"><span class="mxinfo " id="T34:U621"><span class="fcn" id="F28N5:B817">Roty</span>(<span class="mxinfo " id="T8:U622"><span class="var type1" id="S9T20U819">theta</span>(<span class="var type1" id="S35T8U820">j</span>)</span>)</span>, <span class="mxinfo " id="T41:U625"><span class="mxinfo " id="T42:U626">[<span class="mxinfo " id="T8:U627"><span class="mxinfo " id="T43:U628"><span class="mxinfo " id="T9:U629"><span class="var type1" id="S10T5U827">snake</span>.link</span>(<span class="var type1" id="S34T8U829">i</span>)</span>.length</span> <span class="mxinfo " id="T8:U632">0</span> <span class="mxinfo " id="T8:U633">0</span>]</span>'</span></span>; <span class="mxinfo " id="T44:U634">[<span class="mxinfo " id="T8:U635">0</span> <span class="mxinfo " id="T8:U636">0</span> <span class="mxinfo " id="T8:U637">0</span> <span class="mxinfo " id="T8:U638">1</span>]</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,54" id="srcline54">54</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,55" id="srcline55">55</a></span><span class="line">        <span class="mxinfo " id="T39:U639"><span class="var type1" id="S36T39U843">A</span>=<span class="mxinfo " id="T39:U641">[<span class="mxinfo " id="T40:U642"><span class="mxinfo " id="T34:U643"><span class="fcn" id="F29N6:B847">Rotz</span>(<span class="mxinfo " id="T8:U644"><span class="var type1" id="S9T20U849">theta</span>(<span class="var type1" id="S35T8U850">j</span>)</span>)</span>, <span class="mxinfo " id="T41:U647"><span class="mxinfo " id="T42:U648">[<span class="mxinfo " id="T8:U649"><span class="mxinfo " id="T43:U650"><span class="mxinfo " id="T9:U651"><span class="var type1" id="S10T5U857">snake</span>.link</span>(<span class="var type1" id="S34T8U859">i</span>)</span>.length</span> <span class="mxinfo " id="T8:U654">0</span> <span class="mxinfo " id="T8:U655">0</span>]</span>'</span></span>; <span class="mxinfo " id="T44:U656">[<span class="mxinfo " id="T8:U657">0</span> <span class="mxinfo " id="T8:U658">0</span> <span class="mxinfo " id="T8:U659">0</span> <span class="mxinfo " id="T8:U660">1</span>]</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,56" id="srcline56">56</a></span><span class="line">    <span class="keyword">end</span>           </span></span>
<span class="srcline"><span class="lineno"><a href="22,57" id="srcline57">57</a></span><span class="line">     <span class="mxinfo " id="T15:U661"><span class="var type1" id="S40T15U872">twist</span>    = <span class="mxinfo " id="T15:U663"><span class="mxinfo " id="T38:U664"><span class="mxinfo " id="T14:U665"><span class="var type1" id="S10T5U876">snake</span>.joint</span>(<span class="var type1" id="S35T8U878">j</span>)</span>.twist</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="22,58" id="srcline58">58</a></span><span class="line">     <span class="mxinfo " id="T11:U668"><span class="var type1" id="S41T11U882">Adinv</span>    = <span class="mxinfo " id="T11:U670"><span class="fcn" id="F30N2:B884">Ad_inv</span>(<span class="var type1" id="S36T39U885">A</span>)</span></span>;                       </span></span>
<span class="srcline"><span class="lineno"><a href="22,59" id="srcline59">59</a></span><span class="line">     <span class="mxinfo " id="T11:U672"><span class="var type1" id="S43T11U888">ad_tw</span>    = <span class="mxinfo " id="T11:U674"><span class="fcn" id="F152N8:B890">ad</span>(<span class="var type1" id="S40T15U891">twist</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="22,60" id="srcline60">60</a></span><span class="line">     <span class="mxinfo " id="T15:U676"><span class="var type1" id="S17T15U894">nu1</span>      = <span class="mxinfo " id="T15:U678"><span class="mxinfo " id="T15:U679"><span class="var type1" id="S41T11U897">Adinv</span>*<span class="var type1" id="S17T15U898">nu1</span></span> + <span class="mxinfo " id="T15:U682"><span class="var type1" id="S40T15U900">twist</span>*<span class="mxinfo " id="T8:U684"><span class="var type1" id="S14T2U902">zeta1</span>(<span class="mxinfo " id="T8:U686"><span class="mxinfo " id="T8:U687">6</span>+<span class="var type1" id="S35T8U905">j</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,61" id="srcline61">61</a></span><span class="line">     <span class="mxinfo " id="T15:U689"><span class="var type1" id="S18T15U908">nu2</span>      = <span class="mxinfo " id="T15:U691"><span class="mxinfo " id="T15:U692"><span class="var type1" id="S41T11U911">Adinv</span>*<span class="var type1" id="S18T15U912">nu2</span></span> + <span class="mxinfo " id="T15:U695"><span class="var type1" id="S40T15U914">twist</span>*<span class="mxinfo " id="T8:U697"><span class="var type1" id="S15T4U916">zeta_r</span>(<span class="mxinfo " id="T8:U699"><span class="mxinfo " id="T8:U700">6</span>+<span class="var type1" id="S35T8U919">j</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,62" id="srcline62">62</a></span><span class="line">     <span class="mxinfo " id="T15:U702"><span class="var type1" id="S29T15U922">xi</span>       = <span class="mxinfo " id="T15:U704"><span class="mxinfo " id="T15:U705"><span class="mxinfo " id="T11:U706"><span class="mxinfo " id="T11:U707">-<span class="var type1" id="S43T11U927">ad_tw</span></span>*<span class="mxinfo " id="T8:U709"><span class="var type1" id="S14T2U929">zeta1</span>(<span class="mxinfo " id="T8:U711"><span class="mxinfo " id="T8:U712">6</span>+<span class="var type1" id="S35T8U932">j</span></span>)</span></span>*<span class="var type1" id="S18T15U933">nu2</span></span> + <span class="mxinfo " id="T15:U715"><span class="var type1" id="S41T11U935">Adinv</span>*<span class="var type1" id="S29T15U936">xi</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,63" id="srcline63">63</a></span><span class="line">     <span class="mxinfo " id="T11:U718"><span class="var type1" id="S45T11U939">M</span>        = <span class="mxinfo " id="T11:U720"><span class="mxinfo " id="T43:U721"><span class="mxinfo " id="T9:U722"><span class="var type1" id="S10T5U943">snake</span>.link</span>(<span class="var type1" id="S34T8U945">i</span>)</span>.M</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,64" id="srcline64">64</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="22,65" id="srcline65">65</a></span><span class="line">     <span class="mxinfo " id="T2:U725"><span class="var type1" id="S2T2U949">c</span>        = <span class="mxinfo " id="T2:U727"><span class="var type1" id="S2T2U951">c</span> + <span class="mxinfo " id="T2:U729"><span class="mxinfo " id="T28:U730"><span class="mxinfo " id="T29:U731"><span class="var type1" id="S7T24U955">J</span>(<span class="mxinfo " id="T30:U733">:</span>,<span class="mxinfo " id="T31:U734">:</span>,<span class="var type1" id="S34T8U958">i</span>)</span>'</span>*(<span class="mxinfo " id="T15:U736"><span class="mxinfo " id="T15:U737"><span class="var type1" id="S45T11U962">M</span>*<span class="var type1" id="S29T15U963">xi</span></span> - <span class="mxinfo " id="T15:U740"><span class="mxinfo " id="T11:U741"><span class="fcn" id="F102N7:B966">W</span>(<span class="mxinfo " id="T15:U742"><span class="var type1" id="S45T11U968">M</span>*<span class="var type1" id="S17T15U969">nu1</span></span>)</span>*<span class="var type1" id="S18T15U970">nu2</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,66" id="srcline66">66</a></span><span class="line">     <span class="keyword">if</span> <span class="mxinfo " id="T37:U746"><span class="mxinfo " id="T8:U747"><span class="mxinfo " id="T43:U748"><span class="mxinfo " id="T9:U749"><span class="var type1" id="S10T5U977">snake</span>.link</span>(<span class="var type1" id="S34T8U979">i</span>)</span>.dragtype</span>==<span class="mxinfo " id="T8:U752">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="22,67" id="srcline67">67</a></span><span class="line">          <span class="mxinfo " id="T2:U753"><span class="var type1" id="S3T2U984">d</span>   = <span class="mxinfo " id="T2:U755"><span class="var type1" id="S3T2U986">d</span> + <span class="mxinfo " id="T2:U757"><span class="mxinfo " id="T28:U758"><span class="mxinfo " id="T29:U759"><span class="var type1" id="S7T24U990">J</span>(<span class="mxinfo " id="T30:U761">:</span>,<span class="mxinfo " id="T31:U762">:</span>,<span class="var type1" id="S34T8U993">i</span>)</span>'</span>*<span class="mxinfo " id="T15:U764">zeros(<span class="mxinfo " id="T8:U765">6</span>,1)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,68" id="srcline68">68</a></span><span class="line">          <span class="mxinfo " id="T32:U766"><span class="mxinfo " id="T32:U767"><span class="var type1" id="S5T25U1001">D</span>(<span class="mxinfo " id="T30:U769">:</span>,<span class="mxinfo " id="T33:U770">:</span>,<span class="var type1" id="S34T8U1004">i</span>)</span>=<span class="mxinfo " id="T32:U772">zeros(<span class="mxinfo " id="T8:U773">6</span>,<span class="mxinfo " id="T8:U774">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,69" id="srcline69">69</a></span><span class="line">     <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,70" id="srcline70">70</a></span><span class="line">          <span class="mxinfo " id="T2:U775"><span class="var type1" id="S3T2U1012">d</span>   = <span class="mxinfo " id="T2:U777"><span class="var type1" id="S3T2U1014">d</span> + <span class="mxinfo " id="T2:U779"><span class="mxinfo " id="T28:U780"><span class="mxinfo " id="T29:U781"><span class="var type1" id="S7T24U1018">J</span>(<span class="mxinfo " id="T30:U783">:</span>,<span class="mxinfo " id="T31:U784">:</span>,<span class="var type1" id="S34T8U1021">i</span>)</span>'</span>*<span class="mxinfo " id="T15:U786"><span class="fcn" id="F110N12:B1023">drag</span>(<span class="var type1" id="S17T15U1024">nu1</span>,<span class="var type1" id="S18T15U1025">nu2</span>,<span class="mxinfo " id="T8:U789"><span class="mxinfo " id="T43:U790"><span class="mxinfo " id="T9:U791"><span class="var type1" id="S10T5U1029">snake</span>.link</span>(<span class="var type1" id="S34T8U1031">i</span>)</span>.length</span>,<span class="mxinfo " id="T8:U794"><span class="var type1" id="S11T16U1034">pp</span>.denw</span>,<span class="mxinfo " id="T8:U796"><span class="var type1" id="S10T5U1037">snake</span>.r</span>,<span class="var type1" id="S16T36U1039">dragcoeff_for_comparison</span>)</span></span></span></span>;  <span class="comment">%Sjekk om det er riktig Ã¥ ha i her</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,71" id="srcline71">71</a></span><span class="line">          <span class="mxinfo " id="T8:U799"><span class="mxinfo " id="T8:U800"><span class="var type1" id="S5T25U1043">D</span>(<span class="mxinfo " id="T8:U802">1</span>,<span class="mxinfo " id="T8:U803">1</span>,<span class="var type1" id="S34T8U1046">i</span>)</span>=<span class="mxinfo " id="T8:U805"><span class="mxinfo " id="T8:U806"><span class="mxinfo " id="T8:U807"><span class="mxinfo " id="T8:U808"><span class="mxinfo " id="T8:U809"><span class="mxinfo " id="T8:U810">.5</span>*<span class="var type1" id="S27T8U1053">rho</span></span>*<span class="mxinfo " id="T8:U812">pi</span></span>*<span class="mxinfo " id="T8:U813"><span class="mxinfo " id="T8:U814"><span class="var type1" id="S10T5U1058">snake</span>.r</span>^2</span></span>*<span class="mxinfo " id="T8:U816">abs(<span class="mxinfo " id="T8:U817"><span class="var type1" id="S17T15U1064">nu1</span>(<span class="mxinfo " id="T45:U819">1</span>)</span>)</span></span>*<span class="mxinfo " id="T8:U820"><span class="var type1" id="S18T15U1067">nu2</span>(<span class="mxinfo " id="T8:U822">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,72" id="srcline72">72</a></span><span class="line">            <span class="mxinfo " id="T8:U823"><span class="mxinfo " id="T8:U824"><span class="var type1" id="S5T25U1072">D</span>(<span class="mxinfo " id="T8:U826">1</span>,<span class="mxinfo " id="T8:U827">4</span>,<span class="var type1" id="S34T8U1075">i</span>)</span>=<span class="mxinfo " id="T8:U829"><span class="mxinfo " id="T8:U830"><span class="mxinfo " id="T8:U831"><span class="mxinfo " id="T8:U832"><span class="mxinfo " id="T8:U833"><span class="var type1" id="S27T8U1081">rho</span>*<span class="mxinfo " id="T8:U835"><span class="var type1" id="S10T5U1083">snake</span>.r</span></span>*<span class="mxinfo " id="T8:U837"><span class="mxinfo " id="T43:U838"><span class="mxinfo " id="T9:U839"><span class="var type1" id="S10T5U1088">snake</span>.link</span>(<span class="var type1" id="S34T8U1090">i</span>)</span>.length</span></span>*<span class="var type1" id="S25T8U1092">v_ref</span></span>*<span class="var type1" id="S12T8U1093">beta</span></span>*<span class="mxinfo " id="T8:U844"><span class="var type1" id="S18T15U1095">nu2</span>(<span class="mxinfo " id="T8:U846">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,73" id="srcline73">73</a></span><span class="line">            <span class="mxinfo " id="T8:U847"><span class="mxinfo " id="T8:U848"><span class="var type1" id="S5T25U1100">D</span>(<span class="mxinfo " id="T8:U850">2</span>,<span class="mxinfo " id="T8:U851">3</span>,<span class="var type1" id="S34T8U1103">i</span>)</span>=<span class="mxinfo " id="T8:U853"><span class="mxinfo " id="T8:U854"><span class="mxinfo " id="T8:U855"><span class="mxinfo " id="T8:U856"><span class="var type1" id="S27T8U1108">rho</span>*<span class="mxinfo " id="T8:U858"><span class="var type1" id="S10T5U1110">snake</span>.r</span></span>*<span class="var type1" id="S22T8U1112">dx</span></span>*<span class="mxinfo " id="T8:U861"><span class="mxinfo " id="T43:U862"><span class="mxinfo " id="T9:U863"><span class="var type1" id="S10T5U1116">snake</span>.link</span>(<span class="var type1" id="S34T8U1118">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U866">trapz(<span class="mxinfo " id="T6:U867"><span class="var type1" id="S23T6U1123">sqrtx</span>.*(<span class="mxinfo " id="T6:U869"><span class="mxinfo " id="T8:U870"><span class="var type1" id="S18T15U1127">nu2</span>(<span class="mxinfo " id="T8:U872">2</span>)</span>+<span class="mxinfo " id="T6:U873"><span class="mxinfo " id="T8:U874"><span class="var type1" id="S18T15U1131">nu2</span>(<span class="mxinfo " id="T45:U876">6</span>)</span>*<span class="var type1" id="S20T6U1133">x</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,74" id="srcline74">74</a></span><span class="line">            <span class="mxinfo " id="T8:U878"><span class="mxinfo " id="T8:U879"><span class="var type1" id="S5T25U1137">D</span>(<span class="mxinfo " id="T8:U881">2</span>,<span class="mxinfo " id="T8:U882">4</span>,<span class="var type1" id="S34T8U1140">i</span>)</span>=<span class="mxinfo " id="T8:U884"><span class="mxinfo " id="T8:U885"><span class="mxinfo " id="T8:U886"><span class="mxinfo " id="T8:U887"><span class="var type1" id="S27T8U1145">rho</span>*<span class="mxinfo " id="T8:U889"><span class="var type1" id="S10T5U1147">snake</span>.r</span></span>*<span class="mxinfo " id="T8:U891"><span class="mxinfo " id="T43:U892"><span class="mxinfo " id="T9:U893"><span class="var type1" id="S10T5U1152">snake</span>.link</span>(<span class="var type1" id="S34T8U1154">i</span>)</span>.length</span></span>*<span class="var type1" id="S25T8U1156">v_ref</span></span>*(<span class="mxinfo " id="T8:U897"><span class="mxinfo " id="T8:U898"><span class="var type1" id="S18T15U1160">nu2</span>(<span class="mxinfo " id="T8:U900">2</span>)</span>+<span class="mxinfo " id="T8:U901"><span class="mxinfo " id="T8:U902"><span class="mxinfo " id="T8:U903">0.5</span>*<span class="mxinfo " id="T8:U904"><span class="mxinfo " id="T43:U905"><span class="mxinfo " id="T9:U906"><span class="var type1" id="S10T5U1168">snake</span>.link</span>(<span class="var type1" id="S34T8U1170">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U909"><span class="var type1" id="S18T15U1173">nu2</span>(<span class="mxinfo " id="T8:U911">6</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,75" id="srcline75">75</a></span><span class="line">            <span class="mxinfo " id="T8:U912"><span class="mxinfo " id="T8:U913"><span class="var type1" id="S5T25U1178">D</span>(<span class="mxinfo " id="T8:U915">3</span>,<span class="mxinfo " id="T8:U916">3</span>,<span class="var type1" id="S34T8U1181">i</span>)</span>=<span class="mxinfo " id="T8:U918"><span class="mxinfo " id="T8:U919"><span class="mxinfo " id="T8:U920"><span class="mxinfo " id="T8:U921"><span class="var type1" id="S27T8U1186">rho</span>*<span class="mxinfo " id="T8:U923"><span class="var type1" id="S10T5U1188">snake</span>.r</span></span>*<span class="var type1" id="S22T8U1190">dx</span></span>*<span class="mxinfo " id="T8:U926"><span class="mxinfo " id="T43:U927"><span class="mxinfo " id="T9:U928"><span class="var type1" id="S10T5U1194">snake</span>.link</span>(<span class="var type1" id="S34T8U1196">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U931">trapz(<span class="mxinfo " id="T6:U932"><span class="var type1" id="S23T6U1201">sqrtx</span>.*(<span class="mxinfo " id="T6:U934"><span class="mxinfo " id="T8:U935"><span class="var type1" id="S18T15U1205">nu2</span>(<span class="mxinfo " id="T8:U937">3</span>)</span>-<span class="mxinfo " id="T6:U938"><span class="mxinfo " id="T8:U939"><span class="var type1" id="S18T15U1209">nu2</span>(<span class="mxinfo " id="T45:U941">5</span>)</span>*<span class="var type1" id="S20T6U1211">x</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,76" id="srcline76">76</a></span><span class="line">            <span class="mxinfo " id="T8:U943"><span class="mxinfo " id="T8:U944"><span class="var type1" id="S5T25U1215">D</span>(<span class="mxinfo " id="T8:U946">3</span>,<span class="mxinfo " id="T8:U947">4</span>,<span class="var type1" id="S34T8U1218">i</span>)</span>=<span class="mxinfo " id="T8:U949"><span class="mxinfo " id="T8:U950"><span class="mxinfo " id="T8:U951"><span class="mxinfo " id="T8:U952"><span class="var type1" id="S27T8U1223">rho</span>*<span class="mxinfo " id="T8:U954"><span class="var type1" id="S10T5U1225">snake</span>.r</span></span>*<span class="mxinfo " id="T8:U956"><span class="mxinfo " id="T43:U957"><span class="mxinfo " id="T9:U958"><span class="var type1" id="S10T5U1230">snake</span>.link</span>(<span class="var type1" id="S34T8U1232">i</span>)</span>.length</span></span>*<span class="var type1" id="S25T8U1234">v_ref</span></span>*(<span class="mxinfo " id="T8:U962"><span class="mxinfo " id="T8:U963"><span class="var type1" id="S18T15U1238">nu2</span>(<span class="mxinfo " id="T8:U965">3</span>)</span>-<span class="mxinfo " id="T8:U966"><span class="mxinfo " id="T8:U967"><span class="mxinfo " id="T8:U968">0.5</span>*<span class="mxinfo " id="T8:U969"><span class="mxinfo " id="T43:U970"><span class="mxinfo " id="T9:U971"><span class="var type1" id="S10T5U1246">snake</span>.link</span>(<span class="var type1" id="S34T8U1248">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U974"><span class="var type1" id="S18T15U1251">nu2</span>(<span class="mxinfo " id="T8:U976">5</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,77" id="srcline77">77</a></span><span class="line">            <span class="mxinfo " id="T8:U977"><span class="mxinfo " id="T8:U978"><span class="var type1" id="S5T25U1256">D</span>(<span class="mxinfo " id="T8:U980">4</span>,<span class="mxinfo " id="T8:U981">2</span>,<span class="var type1" id="S34T8U1259">i</span>)</span>=<span class="mxinfo " id="T8:U983"><span class="mxinfo " id="T8:U984"><span class="mxinfo " id="T8:U985"><span class="mxinfo " id="T8:U986"><span class="mxinfo " id="T8:U987"><span class="mxinfo " id="T8:U988"><span class="mxinfo " id="T8:U989">.5</span>*<span class="var type1" id="S27T8U1267">rho</span></span>*<span class="mxinfo " id="T8:U991">pi</span></span>*<span class="mxinfo " id="T8:U992"><span class="mxinfo " id="T43:U993"><span class="mxinfo " id="T9:U994"><span class="var type1" id="S10T5U1273">snake</span>.link</span>(<span class="var type1" id="S34T8U1275">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U997"><span class="mxinfo " id="T8:U998"><span class="var type1" id="S10T5U1279">snake</span>.r</span>^4</span></span>*<span class="mxinfo " id="T8:U1000">abs(<span class="mxinfo " id="T8:U1001"><span class="var type1" id="S17T15U1285">nu1</span>(<span class="mxinfo " id="T45:U1003">4</span>)</span>)</span></span>*<span class="mxinfo " id="T8:U1004"><span class="var type1" id="S18T15U1288">nu2</span>(<span class="mxinfo " id="T8:U1006">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,78" id="srcline78">78</a></span><span class="line">            <span class="mxinfo " id="T8:U1007"><span class="mxinfo " id="T8:U1008"><span class="var type1" id="S5T25U1293">D</span>(<span class="mxinfo " id="T8:U1010">4</span>,<span class="mxinfo " id="T8:U1011">4</span>,<span class="var type1" id="S34T8U1296">i</span>)</span>=<span class="mxinfo " id="T8:U1013"><span class="mxinfo " id="T8:U1014"><span class="mxinfo " id="T8:U1015"><span class="mxinfo " id="T8:U1016"><span class="mxinfo " id="T8:U1017"><span class="mxinfo " id="T8:U1018"><span class="var type1" id="S27T8U1303">rho</span>*<span class="mxinfo " id="T8:U1020"><span class="var type1" id="S10T5U1305">snake</span>.r</span></span>*<span class="mxinfo " id="T8:U1022"><span class="mxinfo " id="T43:U1023"><span class="mxinfo " id="T9:U1024"><span class="var type1" id="S10T5U1310">snake</span>.link</span>(<span class="var type1" id="S34T8U1312">i</span>)</span>.length</span></span>*<span class="var type1" id="S25T8U1314">v_ref</span></span>*<span class="var type1" id="S13T8U1315">gamma</span></span>*<span class="mxinfo " id="T8:U1029"><span class="mxinfo " id="T8:U1030"><span class="var type1" id="S10T5U1318">snake</span>.r</span>^2</span></span>*<span class="mxinfo " id="T8:U1032"><span class="var type1" id="S18T15U1322">nu2</span>(<span class="mxinfo " id="T8:U1034">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,79" id="srcline79">79</a></span><span class="line">            <span class="mxinfo " id="T8:U1035"><span class="mxinfo " id="T8:U1036"><span class="var type1" id="S5T25U1327">D</span>(<span class="mxinfo " id="T8:U1038">5</span>,<span class="mxinfo " id="T8:U1039">3</span>,<span class="var type1" id="S34T8U1330">i</span>)</span>=<span class="mxinfo " id="T8:U1041"><span class="mxinfo " id="T8:U1042"><span class="mxinfo " id="T8:U1043"><span class="mxinfo " id="T8:U1044"><span class="var type1" id="S27T8U1335">rho</span>*<span class="mxinfo " id="T8:U1046"><span class="var type1" id="S10T5U1337">snake</span>.r</span></span>*<span class="var type1" id="S22T8U1339">dx</span></span>*<span class="mxinfo " id="T8:U1049"><span class="mxinfo " id="T43:U1050"><span class="mxinfo " id="T9:U1051"><span class="var type1" id="S10T5U1343">snake</span>.link</span>(<span class="var type1" id="S34T8U1345">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U1054">trapz(<span class="mxinfo " id="T6:U1055"><span class="var type1" id="S23T6U1350">sqrtx</span>.*(<span class="mxinfo " id="T6:U1057"><span class="mxinfo " id="T6:U1058"><span class="mxinfo " id="T8:U1059">-<span class="mxinfo " id="T8:U1060"><span class="var type1" id="S18T15U1356">nu2</span>(<span class="mxinfo " id="T45:U1062">3</span>)</span></span>*<span class="var type1" id="S20T6U1358">x</span></span>+<span class="mxinfo " id="T6:U1064"><span class="mxinfo " id="T8:U1065"><span class="var type1" id="S18T15U1361">nu2</span>(<span class="mxinfo " id="T45:U1067">5</span>)</span>*<span class="mxinfo " id="T6:U1068"><span class="var type1" id="S20T6U1364">x</span>.^2</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,80" id="srcline80">80</a></span><span class="line">            <span class="mxinfo " id="T8:U1070"><span class="mxinfo " id="T8:U1071"><span class="var type1" id="S5T25U1369">D</span>(<span class="mxinfo " id="T8:U1073">5</span>,<span class="mxinfo " id="T8:U1074">4</span>,<span class="var type1" id="S34T8U1372">i</span>)</span>=<span class="mxinfo " id="T8:U1076"><span class="mxinfo " id="T8:U1077"><span class="mxinfo " id="T8:U1078"><span class="mxinfo " id="T8:U1079"><span class="var type1" id="S27T8U1377">rho</span>*<span class="mxinfo " id="T8:U1081"><span class="var type1" id="S10T5U1379">snake</span>.r</span></span>*<span class="mxinfo " id="T8:U1083"><span class="mxinfo " id="T43:U1084"><span class="mxinfo " id="T9:U1085"><span class="var type1" id="S10T5U1384">snake</span>.link</span>(<span class="var type1" id="S34T8U1386">i</span>)</span>.length</span></span>*<span class="var type1" id="S25T8U1388">v_ref</span></span>*(<span class="mxinfo " id="T8:U1089"><span class="mxinfo " id="T8:U1090"><span class="mxinfo " id="T8:U1091"><span class="mxinfo " id="T8:U1092">-<span class="mxinfo " id="T8:U1093">0.5</span></span>*<span class="mxinfo " id="T8:U1094"><span class="mxinfo " id="T43:U1095"><span class="mxinfo " id="T9:U1096"><span class="var type1" id="S10T5U1398">snake</span>.link</span>(<span class="var type1" id="S34T8U1400">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U1099"><span class="var type1" id="S18T15U1403">nu2</span>(<span class="mxinfo " id="T8:U1101">3</span>)</span></span>+<span class="mxinfo " id="T8:U1102"><span class="mxinfo " id="T8:U1103"><span class="mxinfo " id="T8:U1104"><span class="mxinfo " id="T8:U1105"><span class="mxinfo " id="T43:U1106"><span class="mxinfo " id="T9:U1107"><span class="var type1" id="S10T5U1411">snake</span>.link</span>(<span class="var type1" id="S34T8U1413">i</span>)</span>.length</span>^2</span>*<span class="mxinfo " id="T8:U1110"><span class="var type1" id="S18T15U1417">nu2</span>(<span class="mxinfo " id="T8:U1112">5</span>)</span></span>/<span class="mxinfo " id="T8:U1113">3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,81" id="srcline81">81</a></span><span class="line">            <span class="mxinfo " id="T8:U1114"><span class="mxinfo " id="T8:U1115"><span class="var type1" id="S5T25U1423">D</span>(<span class="mxinfo " id="T8:U1117">6</span>,<span class="mxinfo " id="T8:U1118">3</span>,<span class="var type1" id="S34T8U1426">i</span>)</span>=<span class="mxinfo " id="T8:U1120"><span class="mxinfo " id="T8:U1121"><span class="mxinfo " id="T8:U1122"><span class="mxinfo " id="T8:U1123"><span class="var type1" id="S27T8U1431">rho</span>*<span class="mxinfo " id="T8:U1125"><span class="var type1" id="S10T5U1433">snake</span>.r</span></span>*<span class="var type1" id="S22T8U1435">dx</span></span>*<span class="mxinfo " id="T8:U1128"><span class="mxinfo " id="T43:U1129"><span class="mxinfo " id="T9:U1130"><span class="var type1" id="S10T5U1439">snake</span>.link</span>(<span class="var type1" id="S34T8U1441">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U1133">trapz(<span class="mxinfo " id="T6:U1134"><span class="var type1" id="S23T6U1446">sqrtx</span>.*(<span class="mxinfo " id="T6:U1136"><span class="mxinfo " id="T6:U1137"><span class="mxinfo " id="T8:U1138"><span class="var type1" id="S18T15U1451">nu2</span>(<span class="mxinfo " id="T45:U1140">2</span>)</span>*<span class="var type1" id="S20T6U1453">x</span></span>+<span class="mxinfo " id="T6:U1142"><span class="mxinfo " id="T8:U1143"><span class="var type1" id="S18T15U1456">nu2</span>(<span class="mxinfo " id="T45:U1145">6</span>)</span>*<span class="mxinfo " id="T6:U1146"><span class="var type1" id="S20T6U1459">x</span>.^2</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,82" id="srcline82">82</a></span><span class="line">            <span class="mxinfo " id="T8:U1148"><span class="mxinfo " id="T8:U1149"><span class="var type1" id="S5T25U1464">D</span>(<span class="mxinfo " id="T8:U1151">6</span>,<span class="mxinfo " id="T8:U1152">4</span>,<span class="var type1" id="S34T8U1467">i</span>)</span>=<span class="mxinfo " id="T8:U1154"><span class="mxinfo " id="T8:U1155"><span class="mxinfo " id="T8:U1156"><span class="mxinfo " id="T8:U1157"><span class="var type1" id="S27T8U1472">rho</span>*<span class="mxinfo " id="T8:U1159"><span class="var type1" id="S10T5U1474">snake</span>.r</span></span>*<span class="mxinfo " id="T8:U1161"><span class="mxinfo " id="T43:U1162"><span class="mxinfo " id="T9:U1163"><span class="var type1" id="S10T5U1479">snake</span>.link</span>(<span class="var type1" id="S34T8U1481">i</span>)</span>.length</span></span>*<span class="var type1" id="S25T8U1483">v_ref</span></span>*(<span class="mxinfo " id="T8:U1167"><span class="mxinfo " id="T8:U1168"><span class="mxinfo " id="T8:U1169"><span class="mxinfo " id="T8:U1170">0.5</span>*<span class="mxinfo " id="T8:U1171"><span class="mxinfo " id="T43:U1172"><span class="mxinfo " id="T9:U1173"><span class="var type1" id="S10T5U1492">snake</span>.link</span>(<span class="var type1" id="S34T8U1494">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T8:U1176"><span class="var type1" id="S18T15U1497">nu2</span>(<span class="mxinfo " id="T8:U1178">2</span>)</span></span>+<span class="mxinfo " id="T8:U1179"><span class="mxinfo " id="T8:U1180"><span class="mxinfo " id="T8:U1181"><span class="mxinfo " id="T8:U1182"><span class="mxinfo " id="T43:U1183"><span class="mxinfo " id="T9:U1184"><span class="var type1" id="S10T5U1505">snake</span>.link</span>(<span class="var type1" id="S34T8U1507">i</span>)</span>.length</span>^2</span>*<span class="mxinfo " id="T8:U1187"><span class="var type1" id="S18T15U1511">nu2</span>(<span class="mxinfo " id="T8:U1189">6</span>)</span></span>/<span class="mxinfo " id="T8:U1190">3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,83" id="srcline83">83</a></span><span class="line">          </span></span>
<span class="srcline"><span class="lineno"><a href="22,84" id="srcline84">84</a></span><span class="line">     <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,85" id="srcline85">85</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,86" id="srcline86">86</a></span><span class="line">          <span class="mxinfo " id="T2:U1191"><span class="var type1" id="S4T2U1516">g</span>   = <span class="mxinfo " id="T2:U1193"><span class="var type1" id="S4T2U1518">g</span> + <span class="mxinfo " id="T2:U1195"><span class="mxinfo " id="T56:U1196"><span class="mxinfo " id="T56:U1197"><span class="mxinfo " id="T28:U1198"><span class="mxinfo " id="T29:U1199"><span class="var type1" id="S7T24U1524">J</span>(<span class="mxinfo " id="T30:U1201">:</span>,<span class="mxinfo " id="T31:U1202">:</span>,<span class="var type1" id="S34T8U1527">i</span>)</span>'</span>*<span class="mxinfo " id="T12:U1204"><span class="mxinfo " id="T43:U1205"><span class="mxinfo " id="T9:U1206"><span class="var type1" id="S10T5U1531">snake</span>.link</span>(<span class="var type1" id="S34T8U1533">i</span>)</span>.G</span></span>*<span class="mxinfo " id="T34:U1209"><span class="mxinfo " id="T34:U1210"><span class="var type1" id="S8T23U1537">R</span>(<span class="mxinfo " id="T35:U1212">:</span>,<span class="mxinfo " id="T35:U1213">:</span>,<span class="var type1" id="S34T8U1540">i</span>)</span>'</span></span>*<span class="mxinfo " id="T17:U1215"><span class="var type1" id="S11T16U1542">pp</span>.gdir</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,87" id="srcline87">87</a></span><span class="line"> <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,88" id="srcline88">88</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
