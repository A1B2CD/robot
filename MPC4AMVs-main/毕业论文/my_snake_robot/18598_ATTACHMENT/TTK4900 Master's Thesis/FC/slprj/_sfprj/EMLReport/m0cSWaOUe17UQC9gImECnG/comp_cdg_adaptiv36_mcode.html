<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="22,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type0" id="S2T0U3">c</span>,<span class="var type0" id="S3T0U4">d</span>,<span class="var type1" id="S4T2U5">g</span>,<span class="var type1" id="S5T44U6">D</span>,<span class="var type1" id="S6T13U7">dm</span>] = comp_cdg_adaptiv(<span class="var type1" id="S7T19U10">J</span>,<span class="var type1" id="S8T18U11">R</span>,<span class="var type1" id="S9T17U12">theta</span>,<span class="var type2" id="S10T3V1U13">snake</span>,<span class="var type1" id="S11T14U14">pp</span>,<span class="var type1" id="S12T13U15">beta</span>,<span class="var type1" id="S13T2U16">gamma</span>,<span class="var type1" id="S14T2U17">zeta1</span>,<span class="var type0" id="S15T0U18">zeta_r</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="22,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%This function computes the terms c=C(theta,zeta1)zeta2,</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%d=D(theta,zeta1)zeta2, and g(eta,theta), i.e. the coriolis, drag and</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%hydrostatic forces on the snake. The sign-convention is such that these</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%enter the equation of motion on the left-hand side, i.e. the actual force</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%in terms of newton's laws is what this script puts out times -1.</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,7" id="srcline7"> 7</a></span><span class="line"><span class="var type0" id="S16T0U21">dragcoeff_for_comparison</span> = <span class="message error" id="M2F36C">[0.2, 0.1, 0.8, 0.1, <span class="var type1" id="S12T13U28">beta</span>, <span class="var type1" id="S13T2U29">gamma</span>]</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% dragcoeff_for_comparison = [0.5, 0.5, 0.5, 0.5, beta, gamma];</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,9" id="srcline9"> 9</a></span><span class="line"><span class="var type1" id="S17T13U32">nu1</span> = <span class="var type1" id="S14T2U34">zeta1</span>(1:6);</span></span>
<span class="srcline"><span class="lineno"><a href="22,10" id="srcline10">10</a></span><span class="line"><span class="var type0" id="S18T0U40">nu2</span>=<span class="var type0" id="S15T0U42"><span class="message error" id="M3F36C">zeta_r</span></span>(1:6);</span></span>
<span class="srcline"><span class="lineno"><a href="22,11" id="srcline11">11</a></span><span class="line"><span class="var type1" id="S19T6U48">slices</span> = 10;</span></span>
<span class="srcline"><span class="lineno"><a href="22,12" id="srcline12">12</a></span><span class="line"><span class="var type1" id="S20T4U52">x</span>   = linspace(0,1,<span class="var type1" id="S19T6U57">slices</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="22,13" id="srcline13">13</a></span><span class="line"><span class="var type1" id="S22T6U60">dx</span>  = <span class="var type1" id="S20T4U63">x</span>(2)-<span class="var type1" id="S20T4U66">x</span>(1);</span></span>
<span class="srcline"><span class="lineno"><a href="22,14" id="srcline14">14</a></span><span class="line"><span class="var type1" id="S23T4U70">sqrtx</span>   =  sqrt(<span class="var type1" id="S17T13U80">nu1</span>(2)^2+<span class="var type1" id="S17T13U85">nu1</span>(3)^2+<span class="var type1" id="S20T4U90">x</span>.^2*<span class="var type1" id="S17T13U94">nu1</span>(5)^2+<span class="var type1" id="S20T4U99">x</span>.^2*<span class="var type1" id="S17T13U103">nu1</span>(6)^2+2*<span class="var type1" id="S20T4U110">x</span>*<span class="var type1" id="S17T13U112">nu1</span>(2)*<span class="var type1" id="S17T13U115">nu1</span>(6)-2*<span class="var type1" id="S20T4U121">x</span>*<span class="var type1" id="S17T13U123">nu1</span>(3)*<span class="var type1" id="S17T13U126">nu1</span>(5));</span></span>
<span class="srcline"><span class="lineno"><a href="22,15" id="srcline15">15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,16" id="srcline16">16</a></span><span class="line"><span class="var type1" id="S25T6U130">v_ref</span> = 1;</span></span>
<span class="srcline"><span class="lineno"><a href="22,17" id="srcline17">17</a></span><span class="line"><span class="var type0" id="S5T0U134">D</span>=zeros(<span class="mxinfo " id="T6:U36">6</span>,<span class="mxinfo " id="T6:U37">4</span>,<span class="mxinfo " id="T6:U38"><span class="var type1" id="S10T3U140">snake</span>.n</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="22,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,19" id="srcline19">19</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,20" id="srcline20">20</a></span><span class="line"><span class="var type1" id="S27T6U144">rho</span>=<span class="var type1" id="S11T14U146">pp</span>.denw;</span></span>
<span class="srcline"><span class="lineno"><a href="22,21" id="srcline21">21</a></span><span class="line"><span class="var type0" id="S6T0U150">dm</span>=[0 0 0 0 0 0]';</span></span>
<span class="srcline"><span class="lineno"><a href="22,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,23" id="srcline23">23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,24" id="srcline24">24</a></span><span class="line"><span class="var type0" id="S2T0U162">c</span>  = -<span class="var type1" id="S7T19U168">J</span>(:,:,1)'*<span class="fcn" id="F102N7:B173">W</span>(<span class="var type1" id="S10T3U178">snake</span>.link(1).M*<span class="var type1" id="S17T13U182">nu1</span>)*<span class="var type0" id="S18T0U183"><span class="message error" id="M4F36C">nu2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,25" id="srcline25">25</a></span><span class="line"><span class="var type0" id="S29T0U186">xi</span> = zeros(<span class="mxinfo " id="T6:U45">6</span>,1);</span></span>
<span class="srcline"><span class="lineno"><a href="22,26" id="srcline26">26</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S10T3U197">snake</span>.link(1).dragtype==1</span></span>
<span class="srcline"><span class="lineno"><a href="22,27" id="srcline27">27</a></span><span class="line">        <span class="var type0" id="S3T0U204">d</span>  = <span class="var type0" id="S7T0U208">J</span>(:,:,1)'*zeros(6,1);</span></span>
<span class="srcline"><span class="lineno"><a href="22,28" id="srcline28">28</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,29" id="srcline29">29</a></span><span class="line">        <span class="var type0" id="S3T0U219">d</span>  = <span class="var type1" id="S7T19U223">J</span>(:,:,1)'*drag(<span class="var type1" id="S17T13U229">nu1</span>,<span class="var type0" id="S18T0U230"><span class="message error" id="M5F36C">nu2</span></span>,<span class="var type0" id="S10T0U234">snake</span>.link(1).length,<span class="var type0" id="S11T0U239">pp</span>.denw,<span class="var type0" id="S10T0U242">snake</span>.r,<span class="var type0" id="S16T0U244">dragcoeff_for_comparison</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="22,30" id="srcline30">30</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,31" id="srcline31">31</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="22,32" id="srcline32">32</a></span><span class="line">            <span class="var type0" id="S5T0U248">D</span>(1,1,1)=.5*<span class="var type1" id="S27T6U258">rho</span>*pi*<span class="var type1" id="S10T3U263">snake</span>.r^2*abs(<span class="var type1" id="S17T13U269">nu1</span>(1))*<span class="var type0" id="S18T0U272"><span class="message error" id="M6F36C">nu2</span></span>(1);</span></span>
<span class="srcline"><span class="lineno"><a href="22,33" id="srcline33">33</a></span><span class="line">            <span class="var type0" id="S5T0U277">D</span>(1,4,1)=<span class="var type1" id="S27T6U286">rho</span>*<span class="var type1" id="S10T3U288">snake</span>.r*<span class="var type1" id="S10T3U293">snake</span>.link(1).length*<span class="var type1" id="S25T6U297">v_ref</span>*<span class="var type1" id="S12T13U298">beta</span>*<span class="var type0" id="S18T0U300"><span class="message error" id="M7F36C">nu2</span></span>(1);</span></span>
<span class="srcline"><span class="lineno"><a href="22,34" id="srcline34">34</a></span><span class="line">            <span class="var type0" id="S5T0U305">D</span>(2,3,1)=<span class="var type1" id="S27T6U313">rho</span>*<span class="var type1" id="S10T3U315">snake</span>.r*<span class="var type1" id="S22T6U317">dx</span>*<span class="var type1" id="S10T3U321">snake</span>.link(1).length*trapz(<span class="var type1" id="S23T4U328">sqrtx</span>.*(<span class="var type0" id="S18T0U332"><span class="message error" id="M8F36C">nu2</span></span>(2)+<span class="var type0" id="S18T0U336">nu2</span>(6)*<span class="var type0" id="S20T0U338">x</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="22,35" id="srcline35">35</a></span><span class="line">            <span class="var type0" id="S5T0U342">D</span>(2,4,1)=<span class="var type1" id="S27T6U350">rho</span>*<span class="var type1" id="S10T3U352">snake</span>.r*<span class="var type1" id="S10T3U357">snake</span>.link(1).length*<span class="var type1" id="S25T6U361">v_ref</span>*(<span class="var type0" id="S18T0U365"><span class="message error" id="M9F36C">nu2</span></span>(2)+0.5*<span class="var type0" id="S10T0U373">snake</span>.link(1).length*<span class="var type0" id="S18T0U378">nu2</span>(6));</span></span>
<span class="srcline"><span class="lineno"><a href="22,36" id="srcline36">36</a></span><span class="line">            <span class="var type0" id="S5T0U383">D</span>(3,3,1)=<span class="var type1" id="S27T6U391">rho</span>*<span class="var type1" id="S10T3U393">snake</span>.r*<span class="var type1" id="S22T6U395">dx</span>*<span class="var type1" id="S10T3U399">snake</span>.link(1).length*trapz(<span class="var type1" id="S23T4U406">sqrtx</span>.*(<span class="var type0" id="S18T0U410"><span class="message error" id="M10F36C">nu2</span></span>(3)-<span class="var type0" id="S18T0U414">nu2</span>(5)*<span class="var type0" id="S20T0U416">x</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="22,37" id="srcline37">37</a></span><span class="line">            <span class="var type0" id="S5T0U420">D</span>(3,4,1)=<span class="var type1" id="S27T6U428">rho</span>*<span class="var type1" id="S10T3U430">snake</span>.r*<span class="var type1" id="S10T3U435">snake</span>.link(1).length*<span class="var type1" id="S25T6U439">v_ref</span>*(<span class="var type0" id="S18T0U443"><span class="message error" id="M11F36C">nu2</span></span>(3)-0.5*<span class="var type0" id="S10T0U451">snake</span>.link(1).length*<span class="var type0" id="S18T0U456">nu2</span>(5));</span></span>
<span class="srcline"><span class="lineno"><a href="22,38" id="srcline38">38</a></span><span class="line">            <span class="var type0" id="S5T0U461">D</span>(4,2,1)=.5*<span class="var type1" id="S27T6U472">rho</span>*pi*<span class="var type1" id="S10T3U478">snake</span>.link(1).length*<span class="var type1" id="S10T3U484">snake</span>.r^4*abs(<span class="var type1" id="S17T13U490">nu1</span>(4))*<span class="var type0" id="S18T0U493"><span class="message error" id="M12F36C">nu2</span></span>(4);</span></span>
<span class="srcline"><span class="lineno"><a href="22,39" id="srcline39">39</a></span><span class="line">            <span class="var type0" id="S5T0U498">D</span>(4,4,1)=<span class="var type1" id="S27T6U508">rho</span>*<span class="var type1" id="S10T3U510">snake</span>.r*<span class="var type1" id="S10T3U515">snake</span>.link(1).length*<span class="var type1" id="S25T6U519">v_ref</span>*<span class="var type1" id="S13T2U520">gamma</span>*<span class="var type1" id="S10T3U523">snake</span>.r^2*<span class="var type0" id="S18T0U527"><span class="message error" id="M13F36C">nu2</span></span>(4);</span></span>
<span class="srcline"><span class="lineno"><a href="22,40" id="srcline40">40</a></span><span class="line">            <span class="var type0" id="S5T0U532">D</span>(5,3,1)=<span class="var type1" id="S27T6U540">rho</span>*<span class="var type1" id="S10T3U542">snake</span>.r*<span class="var type1" id="S22T6U544">dx</span>*<span class="var type1" id="S10T3U548">snake</span>.link(1).length*trapz(<span class="var type1" id="S23T4U555">sqrtx</span>.*(-<span class="var type0" id="S18T0U561"><span class="message error" id="M14F36C">nu2</span></span>(3)*<span class="var type0" id="S20T0U563">x</span>+<span class="var type0" id="S18T0U566">nu2</span>(5)*<span class="var type0" id="S20T0U569">x</span>.^2));</span></span>
<span class="srcline"><span class="lineno"><a href="22,41" id="srcline41">41</a></span><span class="line">            <span class="var type0" id="S5T0U574">D</span>(5,4,1)=<span class="var type1" id="S27T6U582">rho</span>*<span class="var type1" id="S10T3U584">snake</span>.r*<span class="var type1" id="S10T3U589">snake</span>.link(1).length*<span class="var type1" id="S25T6U593">v_ref</span>*(-0.5*<span class="var type1" id="S10T3U603">snake</span>.link(1).length*<span class="var type0" id="S18T0U608"><span class="message error" id="M15F36C">nu2</span></span>(3)+<span class="var type0" id="S10T0U616">snake</span>.link(1).length^2*<span class="var type0" id="S18T0U622">nu2</span>(5)/3);</span></span>
<span class="srcline"><span class="lineno"><a href="22,42" id="srcline42">42</a></span><span class="line">            <span class="var type0" id="S5T0U628">D</span>(6,3,1)=<span class="var type1" id="S27T6U636">rho</span>*<span class="var type1" id="S10T3U638">snake</span>.r*<span class="var type1" id="S22T6U640">dx</span>*<span class="var type1" id="S10T3U644">snake</span>.link(1).length*trapz(<span class="var type1" id="S23T4U651">sqrtx</span>.*(<span class="var type0" id="S18T0U656"><span class="message error" id="M16F36C">nu2</span></span>(2)*<span class="var type0" id="S20T0U658">x</span>+<span class="var type0" id="S18T0U661">nu2</span>(6)*<span class="var type0" id="S20T0U664">x</span>.^2));</span></span>
<span class="srcline"><span class="lineno"><a href="22,43" id="srcline43">43</a></span><span class="line">            <span class="var type0" id="S5T0U669">D</span>(6,4,1)=<span class="var type1" id="S27T6U677">rho</span>*<span class="var type1" id="S10T3U679">snake</span>.r*<span class="var type1" id="S10T3U684">snake</span>.link(1).length*<span class="var type1" id="S25T6U688">v_ref</span>*(0.5*<span class="var type1" id="S10T3U697">snake</span>.link(1).length*<span class="var type0" id="S18T0U702"><span class="message error" id="M17F36C">nu2</span></span>(2)+<span class="var type0" id="S10T0U710">snake</span>.link(1).length^2*<span class="var type0" id="S18T0U716">nu2</span>(6)/3);</span></span>
<span class="srcline"><span class="lineno"><a href="22,44" id="srcline44">44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,45" id="srcline45">45</a></span><span class="line">    <span class="var type0" id="S4T0U721">g</span>  = <span class="var type1" id="S7T19U727">J</span>(:,:,1)'*<span class="var type1" id="S10T3U734">snake</span>.link(1).G*<span class="var type1" id="S8T18U740">R</span>(:,:,1)'*<span class="var type1" id="S11T14U745">pp</span>.gdir;</span></span>
<span class="srcline"><span class="lineno"><a href="22,46" id="srcline46">46</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,47" id="srcline47">47</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,48" id="srcline48">48</a></span><span class="line"> <span class="keyword">for</span> <span class="var type1" id="S34T6U749">i</span>=2:<span class="var type1" id="S10T3U753">snake</span>.n</span></span>
<span class="srcline"><span class="lineno"><a href="22,49" id="srcline49">49</a></span><span class="line">     <span class="var type1" id="S35T6U757">j</span>=<span class="var type1" id="S34T6U759">i</span>-1;</span></span>
<span class="srcline"><span class="lineno"><a href="22,50" id="srcline50">50</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S10T3U767">snake</span>.joint(<span class="var type1" id="S35T6U769">j</span>).type==1</span></span>
<span class="srcline"><span class="lineno"><a href="22,51" id="srcline51">51</a></span><span class="line">        <span class="var type1" id="S36T25U774">A</span>=[<span class="fcn" id="F21N4:B778">Rotx</span>(<span class="var type1" id="S9T17U780">theta</span>(<span class="var type1" id="S35T6U781">j</span>)), [<span class="var type1" id="S10T3U788">snake</span>.link(<span class="var type1" id="S34T6U790">i</span>).length 0 0]'; [0 0 0 1]];</span></span>
<span class="srcline"><span class="lineno"><a href="22,52" id="srcline52">52</a></span><span class="line">    <span class="keyword">elseif</span> <span class="var type1" id="S10T3U806">snake</span>.joint(<span class="var type1" id="S35T6U808">j</span>).type==2</span></span>
<span class="srcline"><span class="lineno"><a href="22,53" id="srcline53">53</a></span><span class="line">        <span class="var type1" id="S36T25U813">A</span>=[<span class="fcn" id="F28N5:B817">Roty</span>(<span class="var type1" id="S9T17U819">theta</span>(<span class="var type1" id="S35T6U820">j</span>)), [<span class="var type1" id="S10T3U827">snake</span>.link(<span class="var type1" id="S34T6U829">i</span>).length 0 0]'; [0 0 0 1]];</span></span>
<span class="srcline"><span class="lineno"><a href="22,54" id="srcline54">54</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,55" id="srcline55">55</a></span><span class="line">        <span class="var type1" id="S36T25U843">A</span>=[<span class="fcn" id="F29N6:B847">Rotz</span>(<span class="var type1" id="S9T17U849">theta</span>(<span class="var type1" id="S35T6U850">j</span>)), [<span class="var type1" id="S10T3U857">snake</span>.link(<span class="var type1" id="S34T6U859">i</span>).length 0 0]'; [0 0 0 1]];</span></span>
<span class="srcline"><span class="lineno"><a href="22,56" id="srcline56">56</a></span><span class="line">    <span class="keyword">end</span>           </span></span>
<span class="srcline"><span class="lineno"><a href="22,57" id="srcline57">57</a></span><span class="line">     <span class="var type1" id="S40T13U872">twist</span>    = <span class="var type1" id="S10T3U876">snake</span>.joint(<span class="var type1" id="S35T6U878">j</span>).twist;            </span></span>
<span class="srcline"><span class="lineno"><a href="22,58" id="srcline58">58</a></span><span class="line">     <span class="var type1" id="S41T9U882">Adinv</span>    = <span class="fcn" id="F30N2:B884">Ad_inv</span>(<span class="var type1" id="S36T25U885">A</span>);                       </span></span>
<span class="srcline"><span class="lineno"><a href="22,59" id="srcline59">59</a></span><span class="line">     <span class="var type1" id="S43T9U888">ad_tw</span>    = <span class="fcn" id="F135N8:B890">ad</span>(<span class="var type1" id="S40T13U891">twist</span>); </span></span>
<span class="srcline"><span class="lineno"><a href="22,60" id="srcline60">60</a></span><span class="line">     <span class="var type1" id="S17T13U894">nu1</span>      = <span class="var type1" id="S41T9U897">Adinv</span>*<span class="var type1" id="S17T13U898">nu1</span> + <span class="var type1" id="S40T13U900">twist</span>*<span class="var type1" id="S14T2U902">zeta1</span>(6+<span class="var type1" id="S35T6U905">j</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="22,61" id="srcline61">61</a></span><span class="line">     <span class="var type0" id="S18T0U908">nu2</span>      = <span class="var type1" id="S41T9U911">Adinv</span>*<span class="var type0" id="S18T0U912"><span class="message error" id="M18F36C">nu2</span></span> + <span class="var type0" id="S40T0U914">twist</span>*<span class="var type0" id="S15T0U916">zeta_r</span>(6+<span class="var type0" id="S35T0U919">j</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="22,62" id="srcline62">62</a></span><span class="line">     <span class="var type0" id="S29T0U922">xi</span>       = -<span class="var type1" id="S43T9U927">ad_tw</span>*<span class="var type1" id="S14T2U929">zeta1</span>(6+<span class="var type1" id="S35T6U932">j</span>)*<span class="var type0" id="S18T0U933"><span class="message error" id="M19F36C">nu2</span></span> + <span class="var type0" id="S41T0U935">Adinv</span>*<span class="var type0" id="S29T0U936">xi</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="22,63" id="srcline63">63</a></span><span class="line">     <span class="var type0" id="S45T0U939">M</span>        = <span class="var type1" id="S10T3U943">snake</span>.link(<span class="var type1" id="S34T6U945">i</span>).M;</span></span>
<span class="srcline"><span class="lineno"><a href="22,64" id="srcline64">64</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="22,65" id="srcline65">65</a></span><span class="line">     <span class="var type0" id="S2T0U949">c</span>        = <span class="var type0" id="S2T0U951"><span class="message error" id="M20F36C">c</span></span> + <span class="var type0" id="S7T0U955">J</span>(:,:,<span class="var type0" id="S34T0U958">i</span>)'*(<span class="var type0" id="S45T0U962">M</span>*<span class="var type0" id="S29T0U963">xi</span> - W(<span class="var type0" id="S45T0U968">M</span>*<span class="var type0" id="S17T0U969">nu1</span>)*<span class="var type0" id="S18T0U970">nu2</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="22,66" id="srcline66">66</a></span><span class="line">     <span class="keyword">if</span> <span class="var type1" id="S10T3U977">snake</span>.link(<span class="var type1" id="S34T6U979">i</span>).dragtype==1</span></span>
<span class="srcline"><span class="lineno"><a href="22,67" id="srcline67">67</a></span><span class="line">          <span class="var type0" id="S3T0U984">d</span>   = <span class="var type0" id="S3T0U986"><span class="message error" id="M21F36C">d</span></span> + <span class="var type0" id="S7T0U990">J</span>(:,:,<span class="var type0" id="S34T0U993">i</span>)'*zeros(6,1);</span></span>
<span class="srcline"><span class="lineno"><a href="22,68" id="srcline68">68</a></span><span class="line">          <span class="var type0" id="S5T0U1001">D</span>(:,:,<span class="var type0" id="S34T0U1004">i</span>)=zeros(<span class="mxinfo " id="T6:U153">6</span>,<span class="mxinfo " id="T6:U154">4</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="22,69" id="srcline69">69</a></span><span class="line">     <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,70" id="srcline70">70</a></span><span class="line">          <span class="var type0" id="S3T0U1012">d</span>   = <span class="var type0" id="S3T0U1014"><span class="message error" id="M22F36C">d</span></span> + <span class="var type0" id="S7T0U1018">J</span>(:,:,<span class="var type0" id="S34T0U1021">i</span>)'*drag(<span class="var type0" id="S17T0U1024">nu1</span>,<span class="var type0" id="S18T0U1025">nu2</span>,<span class="var type0" id="S10T0U1029">snake</span>.link(<span class="var type0" id="S34T0U1031">i</span>).length,<span class="var type0" id="S11T0U1034">pp</span>.denw,<span class="var type0" id="S10T0U1037">snake</span>.r,<span class="var type0" id="S16T0U1039">dragcoeff_for_comparison</span>);  <span class="comment">%Sjekk om det er riktig å ha i her</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,71" id="srcline71">71</a></span><span class="line">          <span class="var type0" id="S5T0U1043">D</span>(1,1,<span class="var type0" id="S34T0U1046">i</span>)=.5*<span class="var type1" id="S27T6U1053">rho</span>*pi*<span class="var type1" id="S10T3U1058">snake</span>.r^2*abs(<span class="var type1" id="S17T13U1064">nu1</span>(1))*<span class="var type0" id="S18T0U1067"><span class="message error" id="M23F36C">nu2</span></span>(1);</span></span>
<span class="srcline"><span class="lineno"><a href="22,72" id="srcline72">72</a></span><span class="line">            <span class="var type0" id="S5T0U1072">D</span>(1,4,<span class="var type0" id="S34T0U1075">i</span>)=<span class="var type1" id="S27T6U1081">rho</span>*<span class="var type1" id="S10T3U1083">snake</span>.r*<span class="var type1" id="S10T3U1088">snake</span>.link(<span class="var type1" id="S34T6U1090">i</span>).length*<span class="var type1" id="S25T6U1092">v_ref</span>*<span class="var type1" id="S12T13U1093">beta</span>*<span class="var type0" id="S18T0U1095"><span class="message error" id="M24F36C">nu2</span></span>(1);</span></span>
<span class="srcline"><span class="lineno"><a href="22,73" id="srcline73">73</a></span><span class="line">            <span class="var type0" id="S5T0U1100">D</span>(2,3,<span class="var type0" id="S34T0U1103">i</span>)=<span class="var type1" id="S27T6U1108">rho</span>*<span class="var type1" id="S10T3U1110">snake</span>.r*<span class="var type1" id="S22T6U1112">dx</span>*<span class="var type1" id="S10T3U1116">snake</span>.link(<span class="var type1" id="S34T6U1118">i</span>).length*trapz(<span class="var type1" id="S23T4U1123">sqrtx</span>.*(<span class="var type0" id="S18T0U1127"><span class="message fatal" id="M25F36C">nu2</span></span>(2)+<span class="var type0" id="S18T0U1131">nu2</span>(6)*<span class="var type0" id="S20T0U1133">x</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="22,74" id="srcline74">74</a></span><span class="line">            <span class="var type0" id="S5T0U1137">D</span>(2,4,<span class="var type0" id="S34T0U1140">i</span>)=<span class="var type0" id="S27T0U1145">rho</span>*<span class="var type0" id="S10T0U1147">snake</span>.r*<span class="var type0" id="S10T0U1152">snake</span>.link(<span class="var type0" id="S34T0U1154">i</span>).length*<span class="var type0" id="S25T0U1156">v_ref</span>*(<span class="var type0" id="S18T0U1160">nu2</span>(2)+0.5*<span class="var type0" id="S10T0U1168">snake</span>.link(<span class="var type0" id="S34T0U1170">i</span>).length*<span class="var type0" id="S18T0U1173">nu2</span>(6));</span></span>
<span class="srcline"><span class="lineno"><a href="22,75" id="srcline75">75</a></span><span class="line">            <span class="var type0" id="S5T0U1178">D</span>(3,3,<span class="var type0" id="S34T0U1181">i</span>)=<span class="var type0" id="S27T0U1186">rho</span>*<span class="var type0" id="S10T0U1188">snake</span>.r*<span class="var type0" id="S22T0U1190">dx</span>*<span class="var type0" id="S10T0U1194">snake</span>.link(<span class="var type0" id="S34T0U1196">i</span>).length*trapz(<span class="var type0" id="S23T0U1201">sqrtx</span>.*(<span class="var type0" id="S18T0U1205">nu2</span>(3)-<span class="var type0" id="S18T0U1209">nu2</span>(5)*<span class="var type0" id="S20T0U1211">x</span>));</span></span>
<span class="srcline"><span class="lineno"><a href="22,76" id="srcline76">76</a></span><span class="line">            <span class="var type0" id="S5T0U1215">D</span>(3,4,<span class="var type0" id="S34T0U1218">i</span>)=<span class="var type0" id="S27T0U1223">rho</span>*<span class="var type0" id="S10T0U1225">snake</span>.r*<span class="var type0" id="S10T0U1230">snake</span>.link(<span class="var type0" id="S34T0U1232">i</span>).length*<span class="var type0" id="S25T0U1234">v_ref</span>*(<span class="var type0" id="S18T0U1238">nu2</span>(3)-0.5*<span class="var type0" id="S10T0U1246">snake</span>.link(<span class="var type0" id="S34T0U1248">i</span>).length*<span class="var type0" id="S18T0U1251">nu2</span>(5));</span></span>
<span class="srcline"><span class="lineno"><a href="22,77" id="srcline77">77</a></span><span class="line">            <span class="var type0" id="S5T0U1256">D</span>(4,2,<span class="var type0" id="S34T0U1259">i</span>)=.5*<span class="var type0" id="S27T0U1267">rho</span>*pi*<span class="var type0" id="S10T0U1273">snake</span>.link(<span class="var type0" id="S34T0U1275">i</span>).length*<span class="var type0" id="S10T0U1279">snake</span>.r^4*abs(<span class="var type0" id="S17T0U1285">nu1</span>(4))*<span class="var type0" id="S18T0U1288">nu2</span>(4);</span></span>
<span class="srcline"><span class="lineno"><a href="22,78" id="srcline78">78</a></span><span class="line">            <span class="var type0" id="S5T0U1293">D</span>(4,4,<span class="var type0" id="S34T0U1296">i</span>)=<span class="var type0" id="S27T0U1303">rho</span>*<span class="var type0" id="S10T0U1305">snake</span>.r*<span class="var type0" id="S10T0U1310">snake</span>.link(<span class="var type0" id="S34T0U1312">i</span>).length*<span class="var type0" id="S25T0U1314">v_ref</span>*<span class="var type0" id="S13T0U1315">gamma</span>*<span class="var type0" id="S10T0U1318">snake</span>.r^2*<span class="var type0" id="S18T0U1322">nu2</span>(4);</span></span>
<span class="srcline"><span class="lineno"><a href="22,79" id="srcline79">79</a></span><span class="line">            <span class="var type0" id="S5T0U1327">D</span>(5,3,<span class="var type0" id="S34T0U1330">i</span>)=<span class="var type0" id="S27T0U1335">rho</span>*<span class="var type0" id="S10T0U1337">snake</span>.r*<span class="var type0" id="S22T0U1339">dx</span>*<span class="var type0" id="S10T0U1343">snake</span>.link(<span class="var type0" id="S34T0U1345">i</span>).length*trapz(<span class="var type0" id="S23T0U1350">sqrtx</span>.*(-<span class="var type0" id="S18T0U1356">nu2</span>(3)*<span class="var type0" id="S20T0U1358">x</span>+<span class="var type0" id="S18T0U1361">nu2</span>(5)*<span class="var type0" id="S20T0U1364">x</span>.^2));</span></span>
<span class="srcline"><span class="lineno"><a href="22,80" id="srcline80">80</a></span><span class="line">            <span class="var type0" id="S5T0U1369">D</span>(5,4,<span class="var type0" id="S34T0U1372">i</span>)=<span class="var type0" id="S27T0U1377">rho</span>*<span class="var type0" id="S10T0U1379">snake</span>.r*<span class="var type0" id="S10T0U1384">snake</span>.link(<span class="var type0" id="S34T0U1386">i</span>).length*<span class="var type0" id="S25T0U1388">v_ref</span>*(-0.5*<span class="var type0" id="S10T0U1398">snake</span>.link(<span class="var type0" id="S34T0U1400">i</span>).length*<span class="var type0" id="S18T0U1403">nu2</span>(3)+<span class="var type0" id="S10T0U1411">snake</span>.link(<span class="var type0" id="S34T0U1413">i</span>).length^2*<span class="var type0" id="S18T0U1417">nu2</span>(5)/3);</span></span>
<span class="srcline"><span class="lineno"><a href="22,81" id="srcline81">81</a></span><span class="line">            <span class="var type0" id="S5T0U1423">D</span>(6,3,<span class="var type0" id="S34T0U1426">i</span>)=<span class="var type0" id="S27T0U1431">rho</span>*<span class="var type0" id="S10T0U1433">snake</span>.r*<span class="var type0" id="S22T0U1435">dx</span>*<span class="var type0" id="S10T0U1439">snake</span>.link(<span class="var type0" id="S34T0U1441">i</span>).length*trapz(<span class="var type0" id="S23T0U1446">sqrtx</span>.*(<span class="var type0" id="S18T0U1451">nu2</span>(2)*<span class="var type0" id="S20T0U1453">x</span>+<span class="var type0" id="S18T0U1456">nu2</span>(6)*<span class="var type0" id="S20T0U1459">x</span>.^2));</span></span>
<span class="srcline"><span class="lineno"><a href="22,82" id="srcline82">82</a></span><span class="line">            <span class="var type0" id="S5T0U1464">D</span>(6,4,<span class="var type0" id="S34T0U1467">i</span>)=<span class="var type0" id="S27T0U1472">rho</span>*<span class="var type0" id="S10T0U1474">snake</span>.r*<span class="var type0" id="S10T0U1479">snake</span>.link(<span class="var type0" id="S34T0U1481">i</span>).length*<span class="var type0" id="S25T0U1483">v_ref</span>*(0.5*<span class="var type0" id="S10T0U1492">snake</span>.link(<span class="var type0" id="S34T0U1494">i</span>).length*<span class="var type0" id="S18T0U1497">nu2</span>(2)+<span class="var type0" id="S10T0U1505">snake</span>.link(<span class="var type0" id="S34T0U1507">i</span>).length^2*<span class="var type0" id="S18T0U1511">nu2</span>(6)/3);</span></span>
<span class="srcline"><span class="lineno"><a href="22,83" id="srcline83">83</a></span><span class="line">          </span></span>
<span class="srcline"><span class="lineno"><a href="22,84" id="srcline84">84</a></span><span class="line">     <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,85" id="srcline85">85</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="22,86" id="srcline86">86</a></span><span class="line">          <span class="var type0" id="S4T0U1516">g</span>   = <span class="var type0" id="S4T0U1518">g</span> + <span class="var type0" id="S7T0U1524">J</span>(:,:,<span class="var type0" id="S34T0U1527">i</span>)'*<span class="var type0" id="S10T0U1531">snake</span>.link(<span class="var type0" id="S34T0U1533">i</span>).G*<span class="var type0" id="S8T0U1537">R</span>(:,:,<span class="var type0" id="S34T0U1540">i</span>)'*<span class="var type0" id="S11T0U1542">pp</span>.gdir;</span></span>
<span class="srcline"><span class="lineno"><a href="22,87" id="srcline87">87</a></span><span class="line"> <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="22,88" id="srcline88">88</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
