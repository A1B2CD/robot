<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="42,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">V_b_Ib_ref</span>, <span class="var type1" id="S3T2U4">qdot_ref</span>, <span class="var type1" id="S4T3U5">activeTasks</span>] = CLIK_collisionAvoidance(<span class="var type1" id="S5T6U8">T_I_f</span>, <span class="var type1" id="S6T6U9">T_I_b</span>, <span class="var type1" id="S7T6U10">T_I_r</span>, <span class="var type1" id="S8T7U11">obstacleSurfacePoints</span>, <span class="var type1" id="S9T24U12">Jf</span>, <span class="var type2" id="S10T24V3U13">Jb</span>, <span class="var type1" id="S11T24U14">Jr</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="42,2" id="srcline2"> 2</a></span><span class="line"><span class="mxinfo " id="T4:U11"><span class="var type1" id="S12T4U17">p_I_f</span> = <span class="mxinfo " id="T4:U13"><span class="fcn" id="F131N20:B19">tform2trvec</span>(<span class="var type1" id="S5T6U20">T_I_f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T4:U15"><span class="var type1" id="S14T4U23">p_I_b</span> = <span class="mxinfo " id="T4:U17"><span class="fcn" id="F131N20:B25">tform2trvec</span>(<span class="var type1" id="S6T6U26">T_I_b</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T4:U19"><span class="var type1" id="S15T4U29">p_I_r</span> = <span class="mxinfo " id="T4:U21"><span class="fcn" id="F131N20:B31">tform2trvec</span>(<span class="var type1" id="S7T6U32">T_I_r</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,5" id="srcline5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="42,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T7:U23"><span class="var type1" id="S16T7U35">R_I_f</span> = <span class="mxinfo " id="T7:U25"><span class="fcn" id="F132N19:B37">tform2rotm</span>(<span class="var type1" id="S5T6U38">T_I_f</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T7:U27"><span class="var type1" id="S18T7U41">R_I_b</span> = <span class="mxinfo " id="T7:U29"><span class="fcn" id="F132N19:B43">tform2rotm</span>(<span class="var type1" id="S6T6U44">T_I_b</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T7:U31"><span class="var type1" id="S19T7U47">R_I_r</span> = <span class="mxinfo " id="T7:U33"><span class="fcn" id="F132N19:B49">tform2rotm</span>(<span class="var type1" id="S7T6U50">T_I_r</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,9" id="srcline9"> 9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="42,10" id="srcline10">10</a></span><span class="line"><span class="comment">%% Define tasks</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,11" id="srcline11">11</a></span><span class="line"><span class="comment">%NormTask: A task variable that tries to keep the norm between two points</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,12" id="srcline12">12</a></span><span class="line"><span class="comment">%at a certain value</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,13" id="srcline13">13</a></span><span class="line"><span class="comment">%CONSTRUCTOR: NormTask(Set-based task, sigma_des, gain, weighting matrix)</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,14" id="srcline14">14</a></span><span class="line"><span class="comment">%sigma_des = 0 =&gt; The USM will move towards this point</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,15" id="srcline15">15</a></span><span class="line"><span class="comment">%sigma_des = k =&gt; The USM will keep a distance k from this point</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,16" id="srcline16">16</a></span><span class="line"><span class="keyword">persistent</span> <span class="var type1" id="S20T50U52">tasks</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,17" id="srcline17">17</a></span><span class="line"><span class="keyword">persistent</span> <span class="var type1" id="S21T54U54">CA_r</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,18" id="srcline18">18</a></span><span class="line"><span class="keyword">persistent</span> <span class="var type1" id="S22T56U56">Position_r</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,19" id="srcline19">19</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T26:U38">isempty(<span class="var type0" id="S20T0U61">tasks</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo " id="T8:U39"><span class="var type1" id="S24T8U64">k_CA</span> = <span class="mxinfo " id="T8:U41">3</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,21" id="srcline21">21</a></span><span class="line">    <span class="mxinfo " id="T8:U42"><span class="var type1" id="S25T8U68">k_pos</span> = <span class="mxinfo " id="T8:U44">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,22" id="srcline22">22</a></span><span class="line">    <span class="mxinfo " id="T8:U45"><span class="var type1" id="S26T8U72">distance_CA</span> = <span class="mxinfo " id="T8:U47">0.5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,23" id="srcline23">23</a></span><span class="line">    <span class="mxinfo " id="T8:U48"><span class="var type1" id="S27T8U76">distance_pos</span> = <span class="mxinfo " id="T8:U50">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,24" id="srcline24">24</a></span><span class="line">    <span class="mxinfo " id="T52:U51"><span class="var type1" id="S28T52U80">W</span> = <span class="mxinfo " id="T52:U53">[1 1 1 1 1 1 1 1 1 1]</span></span>; <span class="comment">%6 base velocities + 4 joint angles</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,25" id="srcline25">25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="42,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo " id="T51:U54"><span class="var type1" id="S29T51U95">CA_f</span> = <span class="mxinfo " id="T51:U56"><span class="fcn" id="F133N4:B97">NormTask</span>(<span class="mxinfo " id="T8:U57">1</span>,<span class="var type1" id="S26T8U99">distance_CA</span>,<span class="var type1" id="S24T8U100">k_CA</span>,<span class="var type1" id="S28T52U101">W</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T51:U61"><span class="var type1" id="S31T51U104">CA_b</span> = <span class="mxinfo " id="T51:U63"><span class="fcn" id="F133N4:B106">NormTask</span>(<span class="mxinfo " id="T8:U64">1</span>,<span class="var type1" id="S26T8U108">distance_CA</span>,<span class="mxinfo " id="T8:U66">1</span>,<span class="var type1" id="S28T52U110">W</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T54:U68"><span class="var type1" id="S21T54U113">CA_r</span> = <span class="mxinfo " id="T54:U70"><span class="fcn" id="F133N4:B115">NormTask</span>(<span class="mxinfo " id="T8:U71">1</span>,<span class="var type1" id="S26T8U117">distance_CA</span>,<span class="var type1" id="S24T8U118">k_CA</span>,<span class="var type1" id="S28T52U119">W</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,29" id="srcline29">29</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="42,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo " id="T51:U75"><span class="var type1" id="S32T51U122">Position_f</span> = <span class="mxinfo " id="T51:U77"><span class="fcn" id="F133N4:B124">NormTask</span>(<span class="mxinfo " id="T8:U78">0</span>,<span class="var type1" id="S27T8U126">distance_pos</span>,<span class="var type1" id="S25T8U127">k_pos</span>,<span class="var type1" id="S28T52U128">W</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,31" id="srcline31">31</a></span><span class="line">    <span class="mxinfo " id="T57:U82"><span class="var type1" id="S33T57U131">Position_b</span> = <span class="mxinfo " id="T57:U84"><span class="fcn" id="F133N4:B133">NormTask</span>(<span class="mxinfo " id="T8:U85">0</span>,<span class="var type1" id="S27T8U135">distance_pos</span>,<span class="var type1" id="S25T8U136">k_pos</span>,<span class="var type1" id="S28T52U137">W</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,32" id="srcline32">32</a></span><span class="line">    <span class="mxinfo " id="T56:U89"><span class="var type1" id="S22T56U140">Position_r</span> = <span class="mxinfo " id="T56:U91"><span class="fcn" id="F133N4:B142">NormTask</span>(<span class="mxinfo " id="T8:U92">0</span>,<span class="var type1" id="S27T8U144">distance_pos</span>,<span class="var type1" id="S25T8U145">k_pos</span>,<span class="var type1" id="S28T52U146">W</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,33" id="srcline33">33</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="42,34" id="srcline34">34</a></span><span class="line">    <span class="mxinfo " id="T50:U96"><span class="var type1" id="S20T50U149">tasks</span> = <span class="mxinfo " id="T58:U98">{<span class="var type1" id="S29T51U152">CA_f</span>, <span class="var type1" id="S31T51U153">CA_b</span>, <span class="var type1" id="S32T51U154">Position_f</span>}</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,35" id="srcline35">35</a></span><span class="line">    <span class="comment">%tasks = {Position_f};</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,36" id="srcline36">36</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo " id="T8:U102"><span class="var type1" id="S34T8U157">dim</span> = <span class="mxinfo " id="T8:U104">10</span></span>; <span class="comment">%(6 base vel + 4 joints)</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo " id="T4:U105"><span class="var type1" id="S35T4U161">p_attract</span> = <span class="mxinfo " id="T4:U107">[-15; 0; -180]</span></span>; <span class="comment">%THIS IS THE GOAL POSITION FOR THE END-EFFECTOR</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,39" id="srcline39">39</a></span><span class="line"><span class="comment">%% Update tasks</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,40" id="srcline40">40</a></span><span class="line"><span class="comment">%Extract position Jacobian</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,41" id="srcline41">41</a></span><span class="line"><span class="mxinfo " id="T59:U108"><span class="var type1" id="S36T59U173">Jf_pos</span> = <span class="mxinfo " id="T59:U110"><span class="var type1" id="S9T24U175">Jf</span>(<span class="mxinfo " id="T47:U112">1:3</span>,<span class="mxinfo " id="T60:U113">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo " id="T59:U114"><span class="var type1" id="S37T59U182">Jb_pos</span> = <span class="mxinfo " id="T59:U116"><span class="var type1" id="S10T24U184">Jb</span>(1:3,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,43" id="srcline43">43</a></span><span class="line"><span class="mxinfo " id="T59:U118"><span class="var type1" id="S38T59U191">Jr_pos</span> = <span class="mxinfo " id="T59:U120"><span class="var type1" id="S11T24U193">Jr</span>(<span class="mxinfo " id="T47:U122">1:3</span>,<span class="mxinfo " id="T60:U123">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,44" id="srcline44">44</a></span><span class="line"><span class="mxinfo " id="T61:U124"><span class="var type1" id="S39T61U200">Jr_pos_joints</span> = <span class="mxinfo " id="T61:U126"><span class="var type1" id="S11T24U202">Jr</span>(<span class="mxinfo " id="T47:U128">1:3</span>,<span class="mxinfo " id="T21:U129">7:end</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,45" id="srcline45">45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="42,46" id="srcline46">46</a></span><span class="line"><span class="comment">%Get closest ostacle surface point</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,47" id="srcline47">47</a></span><span class="line"><span class="mxinfo " id="T4:U130"><span class="var type1" id="S41T4U212">p_obst_f</span> = <span class="mxinfo " id="T4:U132"><span class="var type1" id="S8T7U214">obstacleSurfacePoints</span>(<span class="mxinfo " id="T47:U134">:</span>,<span class="mxinfo " id="T34:U135">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,48" id="srcline48">48</a></span><span class="line"><span class="mxinfo " id="T4:U136"><span class="var type1" id="S42T4U219">p_obst_b</span> = <span class="mxinfo " id="T4:U138"><span class="var type1" id="S8T7U221">obstacleSurfacePoints</span>(<span class="mxinfo " id="T47:U140">:</span>,<span class="mxinfo " id="T34:U141">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,49" id="srcline49">49</a></span><span class="line"><span class="mxinfo " id="T4:U142"><span class="var type1" id="S43T4U226">p_obst_r</span> = <span class="mxinfo " id="T4:U144"><span class="var type1" id="S8T7U228">obstacleSurfacePoints</span>(<span class="mxinfo " id="T47:U146">:</span>,<span class="mxinfo " id="T34:U147">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,50" id="srcline50">50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="42,51" id="srcline51">51</a></span><span class="line"><span class="comment">%Calculate task errors and find the task jacobian</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,52" id="srcline52">52</a></span><span class="line"><span class="mxinfo " id="T4:U148"><span class="var type1" id="S44T4U233">p_attract_f</span> = <span class="mxinfo " id="T4:U150"><span class="var type1" id="S12T4U235">p_I_f</span> + <span class="mxinfo " id="T4:U152">(<span class="mxinfo " id="T4:U153"><span class="var type1" id="S35T4U239">p_attract</span> - <span class="var type1" id="S12T4U240">p_I_f</span></span>)/<span class="mxinfo " id="T8:U156">norm(<span class="mxinfo " id="T4:U157"><span class="var type1" id="S35T4U244">p_attract</span> - <span class="var type1" id="S12T4U245">p_I_f</span></span>)</span></span></span></span>;<span class="comment">%Normalise to get const. vel</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,53" id="srcline53">53</a></span><span class="line"><span class="mxinfo " id="T4:U160"><span class="var type1" id="S46T4U248">p_attract_b</span> =  <span class="mxinfo " id="T4:U162"><span class="var type1" id="S14T4U250">p_I_b</span> + <span class="mxinfo " id="T4:U164">(<span class="mxinfo " id="T4:U165"><span class="var type1" id="S35T4U254">p_attract</span> - <span class="var type1" id="S14T4U255">p_I_b</span></span>)/<span class="mxinfo " id="T8:U168">norm(<span class="mxinfo " id="T4:U169"><span class="var type1" id="S35T4U259">p_attract</span> - <span class="var type1" id="S14T4U260">p_I_b</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,54" id="srcline54">54</a></span><span class="line"><span class="mxinfo " id="T4:U172"><span class="var type1" id="S47T4U263">p_attract_r</span> =  <span class="mxinfo " id="T4:U174"><span class="var type1" id="S15T4U265">p_I_r</span> + <span class="mxinfo " id="T4:U176">(<span class="mxinfo " id="T4:U177"><span class="var type1" id="S35T4U269">p_attract</span> - <span class="var type1" id="S15T4U270">p_I_r</span></span>)/<span class="mxinfo " id="T8:U180">norm(<span class="mxinfo " id="T4:U181"><span class="var type1" id="S35T4U274">p_attract</span> - <span class="var type1" id="S15T4U275">p_I_r</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,55" id="srcline55">55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="42,56" id="srcline56">56</a></span><span class="line"><span class="mxinfo " id="T51:U184"><span class="var type1" id="S20T50U280">tasks</span>{<span class="mxinfo " id="T34:U186">1</span>}</span>.<span class="fcn" id="F158N5:B282">update</span>(<span class="var type1" id="S36T59U283">Jf_pos</span>, <span class="var type1" id="S41T4U284">p_obst_f</span>, <span class="var type1" id="S12T4U285">p_I_f</span>, <span class="var type1" id="S16T7U286">R_I_f</span>, <span class="var type1" id="S44T4U287">p_attract_f</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="42,57" id="srcline57">57</a></span><span class="line"><span class="mxinfo " id="T51:U192"><span class="var type1" id="S20T50U292">tasks</span>{<span class="mxinfo " id="T34:U194">3</span>}</span>.<span class="fcn" id="F158N5:B294">update</span>(<span class="var type1" id="S36T59U295">Jf_pos</span>, <span class="var type1" id="S44T4U296">p_attract_f</span>, <span class="var type1" id="S12T4U297">p_I_f</span>, <span class="var type1" id="S16T7U298">R_I_f</span>, <span class="var type1" id="S44T4U299">p_attract_f</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="42,58" id="srcline58">58</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="42,59" id="srcline59">59</a></span><span class="line"><span class="mxinfo " id="T51:U200"><span class="var type1" id="S20T50U304">tasks</span>{<span class="mxinfo " id="T34:U202">2</span>}</span>.<span class="fcn" id="F158N5:B306">update</span>(<span class="var type1" id="S37T59U307">Jb_pos</span>, <span class="var type1" id="S42T4U308">p_obst_b</span>, <span class="var type1" id="S14T4U309">p_I_b</span>, <span class="var type1" id="S18T7U310">R_I_b</span>, <span class="var type1" id="S46T4U311">p_attract_b</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="42,60" id="srcline60">60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="42,61" id="srcline61">61</a></span><span class="line"><span class="comment">%Rear tasks</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,62" id="srcline62">62</a></span><span class="line"><span class="var type1" id="S21T54U315">CA_r</span>.<span class="fcn" id="F252N6:B316">update</span>(<span class="var type1" id="S39T61U317">Jr_pos_joints</span>, <span class="var type1" id="S43T4U318">p_obst_r</span>, <span class="var type1" id="S15T4U319">p_I_r</span>, <span class="var type1" id="S19T7U320">R_I_r</span>, <span class="var type1" id="S47T4U321">p_attract_r</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="42,63" id="srcline63">63</a></span><span class="line"><span class="var type1" id="S22T56U325">Position_r</span>.<span class="fcn" id="F158N5:B326">update</span>(<span class="var type1" id="S38T59U327">Jr_pos</span>,<span class="mxinfo " id="T4:U216">[3;3;-180]</span>,<span class="var type1" id="S15T4U336">p_I_r</span>,<span class="var type1" id="S19T7U337">R_I_r</span>,<span class="var type1" id="S47T4U338">p_attract_r</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="42,64" id="srcline64">64</a></span><span class="line"><span class="comment">%% Calculate system velocities</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,65" id="srcline65">65</a></span><span class="line"><span class="mxinfo " id="T3:U220"><span class="var type1" id="S4T3U341">activeTasks</span> = <span class="mxinfo " id="T3:U222"><span class="fcn" id="F296N12:B343">determineActiveTasks</span>(<span class="var type1" id="S20T50U344">tasks</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,66" id="srcline66">66</a></span><span class="line"><span class="mxinfo " id="T53:U224"><span class="var type1" id="S49T53U347">Q</span> = <span class="mxinfo " id="T53:U226"><span class="fcn" id="F297N15:B349">multipleTaskCLIK</span>(<span class="var type1" id="S20T50U350">tasks</span>, <span class="var type1" id="S4T3U351">activeTasks</span>, <span class="var type1" id="S34T8U352">dim</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,67" id="srcline67">67</a></span><span class="line"><span class="mxinfo " id="T53:U230"><span class="var type1" id="S51T53U355">zeta_ref</span> = <span class="mxinfo " id="T53:U232"><span class="var type1" id="S49T53U357">Q</span>(<span class="mxinfo " id="T60:U234">:</span>,<span class="mxinfo " id="T34:U235">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,68" id="srcline68">68</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="42,69" id="srcline69">69</a></span><span class="line"><span class="comment">%CA for the rear</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,70" id="srcline70">70</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T26:U236"><span class="mxinfo " id="T8:U237"><span class="var type1" id="S21T54U364">CA_r</span>.Active</span> == <span class="mxinfo " id="T8:U239">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="42,71" id="srcline71">71</a></span><span class="line">    <span class="mxinfo " id="T62:U240"><span class="var type1" id="S52T62U369">qr</span> = <span class="mxinfo " id="T45:U242"><span class="mxinfo " id="T45:U243"><span class="var type1" id="S21T54U372">CA_r</span>.J_inv</span>*(<span class="mxinfo " id="T8:U245"><span class="mxinfo " id="T8:U246">0</span> + <span class="mxinfo " id="T8:U247"><span class="mxinfo " id="T8:U248"><span class="var type1" id="S21T54U379">CA_r</span>.Gain</span>*<span class="mxinfo " id="T8:U250"><span class="var type1" id="S21T54U382">CA_r</span>.Sigma_tilde</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,72" id="srcline72">72</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,73" id="srcline73">73</a></span><span class="line">    <span class="mxinfo " id="T62:U252"><span class="var type1" id="S52T62U387">qr</span> = <span class="mxinfo " id="T53:U254">zeros(<span class="var type1" id="S34T8U390">dim</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,74" id="srcline74">74</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="42,75" id="srcline75">75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="42,76" id="srcline76">76</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="42,77" id="srcline77">77</a></span><span class="line"><span class="mxinfo " id="T1:U256"><span class="var type1" id="S2T1U394">V_b_Ib_ref</span> = <span class="mxinfo " id="T1:U258"><span class="var type1" id="S51T53U396">zeta_ref</span>(<span class="mxinfo " id="T63:U260">1:6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,78" id="srcline78">78</a></span><span class="line"><span class="mxinfo " id="T2:U261"><span class="var type1" id="S3T2U402">qdot_ref</span> = <span class="mxinfo " id="T2:U263">[<span class="mxinfo " id="T8:U264"><span class="var type1" id="S52T62U406">qr</span>(<span class="mxinfo " id="T8:U266">4</span>)</span>; <span class="mxinfo " id="T8:U267"><span class="var type1" id="S52T62U410">qr</span>(<span class="mxinfo " id="T8:U269">3</span>)</span>; <span class="mxinfo " id="T8:U270"><span class="var type1" id="S52T62U414">qr</span>(<span class="mxinfo " id="T8:U272">2</span>)</span>; <span class="mxinfo " id="T8:U273"><span class="var type1" id="S52T62U418">qr</span>(<span class="mxinfo " id="T8:U275">1</span>)</span>; <span class="mxinfo " id="T45:U276"><span class="var type1" id="S51T53U422">zeta_ref</span>(<span class="mxinfo " id="T64:U278">7:end</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="42,79" id="srcline79">79</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="42,80" id="srcline80">80</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
