<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="78,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">c</span>,<span class="var type1" id="S3T1U4">d</span>,<span class="var type1" id="S4T1U5">g</span>,<span class="var type1" id="S5T55U6">D</span>,<span class="var type1" id="S6T46U7">dm</span>] = comp_cdg_adaptiv(<span class="var type1" id="S7T54U10">J</span>,<span class="var type1" id="S8T53U11">R</span>,<span class="var type1" id="S9T50U12">theta</span>,<span class="var type2" id="S10T38V2U13">snake</span>,<span class="var type1" id="S11T47U14">pp</span>,<span class="var type1" id="S12T6U15">beta</span>,<span class="var type1" id="S13T6U16">gamma</span>,<span class="var type1" id="S14T1U17">zeta1</span>,<span class="var type1" id="S15T1U18">zeta_r</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="78,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%This function computes the terms c=C(theta,zeta1)zeta2,</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%d=D(theta,zeta1)zeta2, and g(eta,theta), i.e. the coriolis, drag and</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">%hydrostatic forces on the snake. The sign-convention is such that these</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%enter the equation of motion on the left-hand side, i.e. the actual force</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%in terms of newton's laws is what this script puts out times -1.</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T66:U15"><span class="var type1" id="S16T66U21">dragcoeff_for_comparison</span> = <span class="mxinfo " id="T66:U17">[<span class="mxinfo " id="T6:U18">0.2</span>, <span class="mxinfo " id="T6:U19">0.1</span>, <span class="mxinfo " id="T6:U20">0.8</span>, <span class="mxinfo " id="T6:U21">0.1</span>, <span class="var type1" id="S12T6U28">beta</span>, <span class="var type1" id="S13T6U29">gamma</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% dragcoeff_for_comparison = [0.5, 0.5, 0.5, 0.5, beta, gamma];</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T46:U24"><span class="var type1" id="S17T46U32">nu1</span> = <span class="mxinfo " id="T46:U26"><span class="var type1" id="S14T1U34">zeta1</span>(<span class="mxinfo " id="T78:U28">1:6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T46:U29"><span class="var type1" id="S18T46U40">nu2</span>=<span class="mxinfo " id="T46:U31"><span class="var type1" id="S15T1U42">zeta_r</span>(<span class="mxinfo " id="T78:U33">1:6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo " id="T6:U34"><span class="var type1" id="S19T6U48">slices</span> = <span class="mxinfo " id="T6:U36">10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T39:U37"><span class="var type1" id="S20T39U52">x</span>   = <span class="mxinfo " id="T39:U39">linspace(0,1,<span class="var type1" id="S19T6U57">slices</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T6:U41"><span class="var type1" id="S22T6U60">dx</span>  = <span class="mxinfo " id="T6:U43"><span class="mxinfo " id="T6:U44"><span class="var type1" id="S20T39U63">x</span>(<span class="mxinfo " id="T6:U46">2</span>)</span>-<span class="mxinfo " id="T6:U47"><span class="var type1" id="S20T39U66">x</span>(<span class="mxinfo " id="T6:U49">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T39:U50"><span class="var type1" id="S23T39U70">sqrtx</span>   =  <span class="mxinfo " id="T39:U52">sqrt(<span class="mxinfo " id="T39:U53"><span class="mxinfo " id="T39:U54"><span class="mxinfo " id="T39:U55"><span class="mxinfo " id="T39:U56"><span class="mxinfo " id="T6:U57"><span class="mxinfo " id="T6:U58"><span class="mxinfo " id="T6:U59"><span class="var type1" id="S17T46U80">nu1</span>(<span class="mxinfo " id="T23:U61">2</span>)</span>^2</span>+<span class="mxinfo " id="T6:U62"><span class="mxinfo " id="T6:U63"><span class="var type1" id="S17T46U85">nu1</span>(<span class="mxinfo " id="T23:U65">3</span>)</span>^2</span></span>+<span class="mxinfo " id="T39:U66"><span class="mxinfo " id="T39:U67"><span class="var type1" id="S20T39U90">x</span>.^2</span>*<span class="mxinfo " id="T6:U69"><span class="mxinfo " id="T6:U70"><span class="var type1" id="S17T46U94">nu1</span>(<span class="mxinfo " id="T23:U72">5</span>)</span>^2</span></span></span>+<span class="mxinfo " id="T39:U73"><span class="mxinfo " id="T39:U74"><span class="var type1" id="S20T39U99">x</span>.^2</span>*<span class="mxinfo " id="T6:U76"><span class="mxinfo " id="T6:U77"><span class="var type1" id="S17T46U103">nu1</span>(<span class="mxinfo " id="T23:U79">6</span>)</span>^2</span></span></span>+<span class="mxinfo " id="T39:U80"><span class="mxinfo " id="T39:U81"><span class="mxinfo " id="T39:U82">2*<span class="var type1" id="S20T39U110">x</span></span>*<span class="mxinfo " id="T6:U84"><span class="var type1" id="S17T46U112">nu1</span>(<span class="mxinfo " id="T23:U86">2</span>)</span></span>*<span class="mxinfo " id="T6:U87"><span class="var type1" id="S17T46U115">nu1</span>(<span class="mxinfo " id="T23:U89">6</span>)</span></span></span>-<span class="mxinfo " id="T39:U90"><span class="mxinfo " id="T39:U91"><span class="mxinfo " id="T39:U92">2*<span class="var type1" id="S20T39U121">x</span></span>*<span class="mxinfo " id="T6:U94"><span class="var type1" id="S17T46U123">nu1</span>(<span class="mxinfo " id="T23:U96">3</span>)</span></span>*<span class="mxinfo " id="T6:U97"><span class="var type1" id="S17T46U126">nu1</span>(<span class="mxinfo " id="T23:U99">5</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,15" id="srcline15">15</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T6:U100"><span class="var type1" id="S25T6U130">v_ref</span> = <span class="mxinfo " id="T6:U102">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T55:U103"><span class="var type1" id="S5T55U134">D</span>=<span class="mxinfo " id="T55:U105">zeros(<span class="mxinfo " id="T6:U106">6</span>,<span class="mxinfo " id="T6:U107">4</span>,<span class="mxinfo " id="T6:U108"><span class="var type1" id="S10T38U140">snake</span>.n</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,18" id="srcline18">18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,19" id="srcline19">19</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T6:U110"><span class="var type1" id="S27T6U144">rho</span>=<span class="mxinfo " id="T6:U112"><span class="var type1" id="S11T47U146">pp</span>.denw</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T46:U114"><span class="var type1" id="S6T46U150">dm</span>=<span class="mxinfo " id="T46:U116"><span class="mxinfo " id="T66:U117">[<span class="mxinfo " id="T6:U118">0</span> <span class="mxinfo " id="T6:U119">0</span> <span class="mxinfo " id="T6:U120">0</span> <span class="mxinfo " id="T6:U121">0</span> <span class="mxinfo " id="T6:U122">0</span> <span class="mxinfo " id="T6:U123">0</span>]</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,23" id="srcline23">23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T1:U124"><span class="var type1" id="S2T1U162">c</span>  = <span class="mxinfo " id="T1:U126"><span class="mxinfo " id="T58:U127"><span class="mxinfo " id="T58:U128">-<span class="mxinfo " id="T58:U129"><span class="mxinfo " id="T59:U130"><span class="var type1" id="S7T54U168">J</span>(<span class="mxinfo " id="T60:U132">:</span>,<span class="mxinfo " id="T61:U133">:</span>,<span class="mxinfo " id="T23:U134">1</span>)</span>'</span></span>*<span class="mxinfo " id="T42:U135"><span class="fcn" id="F204N7:B173">W</span>(<span class="mxinfo " id="T46:U136"><span class="mxinfo " id="T42:U137"><span class="var type1" id="S10T38U178">snake</span>.link(1).M</span>*<span class="var type1" id="S17T46U182">nu1</span></span>)</span></span>*<span class="var type1" id="S18T46U183">nu2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T46:U141"><span class="var type1" id="S29T46U186">xi</span> = <span class="mxinfo " id="T46:U143">zeros(<span class="mxinfo " id="T6:U144">6</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,26" id="srcline26">26</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S10T38U197">snake</span>.link(1).dragtype==1</span></span>
<span class="srcline"><span class="lineno"><a href="78,27" id="srcline27">27</a></span><span class="line">        <span class="var type0" id="S3T0U204">d</span>  = <span class="var type0" id="S7T0U208">J</span>(:,:,1)'*zeros(6,1);</span></span>
<span class="srcline"><span class="lineno"><a href="78,28" id="srcline28">28</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,29" id="srcline29">29</a></span><span class="line">        <span class="mxinfo " id="T1:U146"><span class="var type1" id="S3T1U219">d</span>  = <span class="mxinfo " id="T1:U148"><span class="mxinfo " id="T58:U149"><span class="mxinfo " id="T59:U150"><span class="var type1" id="S7T54U223">J</span>(<span class="mxinfo " id="T60:U152">:</span>,<span class="mxinfo " id="T61:U153">:</span>,<span class="mxinfo " id="T23:U154">1</span>)</span>'</span>*<span class="mxinfo " id="T46:U155"><span class="fcn" id="F212N13:B228">drag</span>(<span class="var type1" id="S17T46U229">nu1</span>,<span class="var type1" id="S18T46U230">nu2</span>,<span class="mxinfo " id="T6:U158"><span class="var type1" id="S10T38U234">snake</span>.link(1).length</span>,<span class="mxinfo " id="T6:U160"><span class="var type1" id="S11T47U239">pp</span>.denw</span>,<span class="mxinfo " id="T6:U162"><span class="var type1" id="S10T38U242">snake</span>.r</span>,<span class="var type1" id="S16T66U244">dragcoeff_for_comparison</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,30" id="srcline30">30</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,31" id="srcline31">31</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="78,32" id="srcline32">32</a></span><span class="line">            <span class="mxinfo " id="T6:U165"><span class="mxinfo " id="T6:U166"><span class="var type1" id="S5T55U248">D</span>(<span class="mxinfo " id="T6:U168">1</span>,<span class="mxinfo " id="T6:U169">1</span>,<span class="mxinfo " id="T6:U170">1</span>)</span>=<span class="mxinfo " id="T6:U171"><span class="mxinfo " id="T6:U172"><span class="mxinfo " id="T6:U173"><span class="mxinfo " id="T6:U174"><span class="mxinfo " id="T6:U175"><span class="mxinfo " id="T6:U176">.5</span>*<span class="var type1" id="S27T6U258">rho</span></span>*<span class="mxinfo " id="T6:U178">pi</span></span>*<span class="mxinfo " id="T6:U179"><span class="mxinfo " id="T6:U180"><span class="var type1" id="S10T38U263">snake</span>.r</span>^2</span></span>*<span class="mxinfo " id="T6:U182">abs(<span class="mxinfo " id="T6:U183"><span class="var type1" id="S17T46U269">nu1</span>(<span class="mxinfo " id="T23:U185">1</span>)</span>)</span></span>*<span class="mxinfo " id="T6:U186"><span class="var type1" id="S18T46U272">nu2</span>(<span class="mxinfo " id="T6:U188">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,33" id="srcline33">33</a></span><span class="line">            <span class="mxinfo " id="T6:U189"><span class="mxinfo " id="T6:U190"><span class="var type1" id="S5T55U277">D</span>(<span class="mxinfo " id="T6:U192">1</span>,<span class="mxinfo " id="T6:U193">4</span>,<span class="mxinfo " id="T6:U194">1</span>)</span>=<span class="mxinfo " id="T6:U195"><span class="mxinfo " id="T6:U196"><span class="mxinfo " id="T6:U197"><span class="mxinfo " id="T6:U198"><span class="mxinfo " id="T6:U199"><span class="var type1" id="S27T6U286">rho</span>*<span class="mxinfo " id="T6:U201"><span class="var type1" id="S10T38U288">snake</span>.r</span></span>*<span class="mxinfo " id="T6:U203"><span class="mxinfo " id="T72:U204"><span class="mxinfo " id="T41:U205"><span class="var type1" id="S10T38U293">snake</span>.link</span>(<span class="mxinfo " id="T6:U207">1</span>)</span>.length</span></span>*<span class="var type1" id="S25T6U297">v_ref</span></span>*<span class="var type1" id="S12T6U298">beta</span></span>*<span class="mxinfo " id="T6:U210"><span class="var type1" id="S18T46U300">nu2</span>(<span class="mxinfo " id="T6:U212">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,34" id="srcline34">34</a></span><span class="line">            <span class="mxinfo " id="T6:U213"><span class="mxinfo " id="T6:U214"><span class="var type1" id="S5T55U305">D</span>(<span class="mxinfo " id="T6:U216">2</span>,<span class="mxinfo " id="T6:U217">3</span>,<span class="mxinfo " id="T6:U218">1</span>)</span>=<span class="mxinfo " id="T6:U219"><span class="mxinfo " id="T6:U220"><span class="mxinfo " id="T6:U221"><span class="mxinfo " id="T6:U222"><span class="var type1" id="S27T6U313">rho</span>*<span class="mxinfo " id="T6:U224"><span class="var type1" id="S10T38U315">snake</span>.r</span></span>*<span class="var type1" id="S22T6U317">dx</span></span>*<span class="mxinfo " id="T6:U227"><span class="mxinfo " id="T72:U228"><span class="mxinfo " id="T41:U229"><span class="var type1" id="S10T38U321">snake</span>.link</span>(<span class="mxinfo " id="T6:U231">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U232">trapz(<span class="mxinfo " id="T39:U233"><span class="var type1" id="S23T39U328">sqrtx</span>.*(<span class="mxinfo " id="T39:U235"><span class="mxinfo " id="T6:U236"><span class="var type1" id="S18T46U332">nu2</span>(<span class="mxinfo " id="T6:U238">2</span>)</span>+<span class="mxinfo " id="T39:U239"><span class="mxinfo " id="T6:U240"><span class="var type1" id="S18T46U336">nu2</span>(<span class="mxinfo " id="T23:U242">6</span>)</span>*<span class="var type1" id="S20T39U338">x</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,35" id="srcline35">35</a></span><span class="line">            <span class="mxinfo " id="T6:U244"><span class="mxinfo " id="T6:U245"><span class="var type1" id="S5T55U342">D</span>(<span class="mxinfo " id="T6:U247">2</span>,<span class="mxinfo " id="T6:U248">4</span>,<span class="mxinfo " id="T6:U249">1</span>)</span>=<span class="mxinfo " id="T6:U250"><span class="mxinfo " id="T6:U251"><span class="mxinfo " id="T6:U252"><span class="mxinfo " id="T6:U253"><span class="var type1" id="S27T6U350">rho</span>*<span class="mxinfo " id="T6:U255"><span class="var type1" id="S10T38U352">snake</span>.r</span></span>*<span class="mxinfo " id="T6:U257"><span class="mxinfo " id="T72:U258"><span class="mxinfo " id="T41:U259"><span class="var type1" id="S10T38U357">snake</span>.link</span>(<span class="mxinfo " id="T6:U261">1</span>)</span>.length</span></span>*<span class="var type1" id="S25T6U361">v_ref</span></span>*(<span class="mxinfo " id="T6:U263"><span class="mxinfo " id="T6:U264"><span class="var type1" id="S18T46U365">nu2</span>(<span class="mxinfo " id="T6:U266">2</span>)</span>+<span class="mxinfo " id="T6:U267"><span class="mxinfo " id="T6:U268"><span class="mxinfo " id="T6:U269">0.5</span>*<span class="mxinfo " id="T6:U270"><span class="mxinfo " id="T72:U271"><span class="mxinfo " id="T41:U272"><span class="var type1" id="S10T38U373">snake</span>.link</span>(<span class="mxinfo " id="T6:U274">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U275"><span class="var type1" id="S18T46U378">nu2</span>(<span class="mxinfo " id="T6:U277">6</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,36" id="srcline36">36</a></span><span class="line">            <span class="mxinfo " id="T6:U278"><span class="mxinfo " id="T6:U279"><span class="var type1" id="S5T55U383">D</span>(<span class="mxinfo " id="T6:U281">3</span>,<span class="mxinfo " id="T6:U282">3</span>,<span class="mxinfo " id="T6:U283">1</span>)</span>=<span class="mxinfo " id="T6:U284"><span class="mxinfo " id="T6:U285"><span class="mxinfo " id="T6:U286"><span class="mxinfo " id="T6:U287"><span class="var type1" id="S27T6U391">rho</span>*<span class="mxinfo " id="T6:U289"><span class="var type1" id="S10T38U393">snake</span>.r</span></span>*<span class="var type1" id="S22T6U395">dx</span></span>*<span class="mxinfo " id="T6:U292"><span class="mxinfo " id="T72:U293"><span class="mxinfo " id="T41:U294"><span class="var type1" id="S10T38U399">snake</span>.link</span>(<span class="mxinfo " id="T6:U296">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U297">trapz(<span class="mxinfo " id="T39:U298"><span class="var type1" id="S23T39U406">sqrtx</span>.*(<span class="mxinfo " id="T39:U300"><span class="mxinfo " id="T6:U301"><span class="var type1" id="S18T46U410">nu2</span>(<span class="mxinfo " id="T6:U303">3</span>)</span>-<span class="mxinfo " id="T39:U304"><span class="mxinfo " id="T6:U305"><span class="var type1" id="S18T46U414">nu2</span>(<span class="mxinfo " id="T23:U307">5</span>)</span>*<span class="var type1" id="S20T39U416">x</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,37" id="srcline37">37</a></span><span class="line">            <span class="mxinfo " id="T6:U309"><span class="mxinfo " id="T6:U310"><span class="var type1" id="S5T55U420">D</span>(<span class="mxinfo " id="T6:U312">3</span>,<span class="mxinfo " id="T6:U313">4</span>,<span class="mxinfo " id="T6:U314">1</span>)</span>=<span class="mxinfo " id="T6:U315"><span class="mxinfo " id="T6:U316"><span class="mxinfo " id="T6:U317"><span class="mxinfo " id="T6:U318"><span class="var type1" id="S27T6U428">rho</span>*<span class="mxinfo " id="T6:U320"><span class="var type1" id="S10T38U430">snake</span>.r</span></span>*<span class="mxinfo " id="T6:U322"><span class="mxinfo " id="T72:U323"><span class="mxinfo " id="T41:U324"><span class="var type1" id="S10T38U435">snake</span>.link</span>(<span class="mxinfo " id="T6:U326">1</span>)</span>.length</span></span>*<span class="var type1" id="S25T6U439">v_ref</span></span>*(<span class="mxinfo " id="T6:U328"><span class="mxinfo " id="T6:U329"><span class="var type1" id="S18T46U443">nu2</span>(<span class="mxinfo " id="T6:U331">3</span>)</span>-<span class="mxinfo " id="T6:U332"><span class="mxinfo " id="T6:U333"><span class="mxinfo " id="T6:U334">0.5</span>*<span class="mxinfo " id="T6:U335"><span class="mxinfo " id="T72:U336"><span class="mxinfo " id="T41:U337"><span class="var type1" id="S10T38U451">snake</span>.link</span>(<span class="mxinfo " id="T6:U339">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U340"><span class="var type1" id="S18T46U456">nu2</span>(<span class="mxinfo " id="T6:U342">5</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,38" id="srcline38">38</a></span><span class="line">            <span class="mxinfo " id="T6:U343"><span class="mxinfo " id="T6:U344"><span class="var type1" id="S5T55U461">D</span>(<span class="mxinfo " id="T6:U346">4</span>,<span class="mxinfo " id="T6:U347">2</span>,<span class="mxinfo " id="T6:U348">1</span>)</span>=<span class="mxinfo " id="T6:U349"><span class="mxinfo " id="T6:U350"><span class="mxinfo " id="T6:U351"><span class="mxinfo " id="T6:U352"><span class="mxinfo " id="T6:U353"><span class="mxinfo " id="T6:U354"><span class="mxinfo " id="T6:U355">.5</span>*<span class="var type1" id="S27T6U472">rho</span></span>*<span class="mxinfo " id="T6:U357">pi</span></span>*<span class="mxinfo " id="T6:U358"><span class="mxinfo " id="T72:U359"><span class="mxinfo " id="T41:U360"><span class="var type1" id="S10T38U478">snake</span>.link</span>(<span class="mxinfo " id="T6:U362">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U363"><span class="mxinfo " id="T6:U364"><span class="var type1" id="S10T38U484">snake</span>.r</span>^4</span></span>*<span class="mxinfo " id="T6:U366">abs(<span class="mxinfo " id="T6:U367"><span class="var type1" id="S17T46U490">nu1</span>(<span class="mxinfo " id="T23:U369">4</span>)</span>)</span></span>*<span class="mxinfo " id="T6:U370"><span class="var type1" id="S18T46U493">nu2</span>(<span class="mxinfo " id="T6:U372">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,39" id="srcline39">39</a></span><span class="line">            <span class="mxinfo " id="T6:U373"><span class="mxinfo " id="T6:U374"><span class="var type1" id="S5T55U498">D</span>(<span class="mxinfo " id="T6:U376">4</span>,<span class="mxinfo " id="T6:U377">4</span>,<span class="mxinfo " id="T6:U378">1</span>)</span>=<span class="mxinfo " id="T6:U379"><span class="mxinfo " id="T6:U380"><span class="mxinfo " id="T6:U381"><span class="mxinfo " id="T6:U382"><span class="mxinfo " id="T6:U383"><span class="mxinfo " id="T6:U384"><span class="var type1" id="S27T6U508">rho</span>*<span class="mxinfo " id="T6:U386"><span class="var type1" id="S10T38U510">snake</span>.r</span></span>*<span class="mxinfo " id="T6:U388"><span class="mxinfo " id="T72:U389"><span class="mxinfo " id="T41:U390"><span class="var type1" id="S10T38U515">snake</span>.link</span>(<span class="mxinfo " id="T6:U392">1</span>)</span>.length</span></span>*<span class="var type1" id="S25T6U519">v_ref</span></span>*<span class="var type1" id="S13T6U520">gamma</span></span>*<span class="mxinfo " id="T6:U395"><span class="mxinfo " id="T6:U396"><span class="var type1" id="S10T38U523">snake</span>.r</span>^2</span></span>*<span class="mxinfo " id="T6:U398"><span class="var type1" id="S18T46U527">nu2</span>(<span class="mxinfo " id="T6:U400">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,40" id="srcline40">40</a></span><span class="line">            <span class="mxinfo " id="T6:U401"><span class="mxinfo " id="T6:U402"><span class="var type1" id="S5T55U532">D</span>(<span class="mxinfo " id="T6:U404">5</span>,<span class="mxinfo " id="T6:U405">3</span>,<span class="mxinfo " id="T6:U406">1</span>)</span>=<span class="mxinfo " id="T6:U407"><span class="mxinfo " id="T6:U408"><span class="mxinfo " id="T6:U409"><span class="mxinfo " id="T6:U410"><span class="var type1" id="S27T6U540">rho</span>*<span class="mxinfo " id="T6:U412"><span class="var type1" id="S10T38U542">snake</span>.r</span></span>*<span class="var type1" id="S22T6U544">dx</span></span>*<span class="mxinfo " id="T6:U415"><span class="mxinfo " id="T72:U416"><span class="mxinfo " id="T41:U417"><span class="var type1" id="S10T38U548">snake</span>.link</span>(<span class="mxinfo " id="T6:U419">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U420">trapz(<span class="mxinfo " id="T39:U421"><span class="var type1" id="S23T39U555">sqrtx</span>.*(<span class="mxinfo " id="T39:U423"><span class="mxinfo " id="T39:U424"><span class="mxinfo " id="T6:U425">-<span class="mxinfo " id="T6:U426"><span class="var type1" id="S18T46U561">nu2</span>(<span class="mxinfo " id="T23:U428">3</span>)</span></span>*<span class="var type1" id="S20T39U563">x</span></span>+<span class="mxinfo " id="T39:U430"><span class="mxinfo " id="T6:U431"><span class="var type1" id="S18T46U566">nu2</span>(<span class="mxinfo " id="T23:U433">5</span>)</span>*<span class="mxinfo " id="T39:U434"><span class="var type1" id="S20T39U569">x</span>.^2</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,41" id="srcline41">41</a></span><span class="line">            <span class="mxinfo " id="T6:U436"><span class="mxinfo " id="T6:U437"><span class="var type1" id="S5T55U574">D</span>(<span class="mxinfo " id="T6:U439">5</span>,<span class="mxinfo " id="T6:U440">4</span>,<span class="mxinfo " id="T6:U441">1</span>)</span>=<span class="mxinfo " id="T6:U442"><span class="mxinfo " id="T6:U443"><span class="mxinfo " id="T6:U444"><span class="mxinfo " id="T6:U445"><span class="var type1" id="S27T6U582">rho</span>*<span class="mxinfo " id="T6:U447"><span class="var type1" id="S10T38U584">snake</span>.r</span></span>*<span class="mxinfo " id="T6:U449"><span class="mxinfo " id="T72:U450"><span class="mxinfo " id="T41:U451"><span class="var type1" id="S10T38U589">snake</span>.link</span>(<span class="mxinfo " id="T6:U453">1</span>)</span>.length</span></span>*<span class="var type1" id="S25T6U593">v_ref</span></span>*(<span class="mxinfo " id="T6:U455"><span class="mxinfo " id="T6:U456"><span class="mxinfo " id="T6:U457"><span class="mxinfo " id="T6:U458">-<span class="mxinfo " id="T6:U459">0.5</span></span>*<span class="mxinfo " id="T6:U460"><span class="mxinfo " id="T72:U461"><span class="mxinfo " id="T41:U462"><span class="var type1" id="S10T38U603">snake</span>.link</span>(<span class="mxinfo " id="T6:U464">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U465"><span class="var type1" id="S18T46U608">nu2</span>(<span class="mxinfo " id="T6:U467">3</span>)</span></span>+<span class="mxinfo " id="T6:U468"><span class="mxinfo " id="T6:U469"><span class="mxinfo " id="T6:U470"><span class="mxinfo " id="T6:U471"><span class="var type1" id="S10T38U616">snake</span>.link(1).length</span>^2</span>*<span class="mxinfo " id="T6:U473"><span class="var type1" id="S18T46U622">nu2</span>(<span class="mxinfo " id="T23:U475">5</span>)</span></span>/<span class="mxinfo " id="T6:U476">3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,42" id="srcline42">42</a></span><span class="line">            <span class="mxinfo " id="T6:U477"><span class="mxinfo " id="T6:U478"><span class="var type1" id="S5T55U628">D</span>(<span class="mxinfo " id="T6:U480">6</span>,<span class="mxinfo " id="T6:U481">3</span>,<span class="mxinfo " id="T6:U482">1</span>)</span>=<span class="mxinfo " id="T6:U483"><span class="mxinfo " id="T6:U484"><span class="mxinfo " id="T6:U485"><span class="mxinfo " id="T6:U486"><span class="var type1" id="S27T6U636">rho</span>*<span class="mxinfo " id="T6:U488"><span class="var type1" id="S10T38U638">snake</span>.r</span></span>*<span class="var type1" id="S22T6U640">dx</span></span>*<span class="mxinfo " id="T6:U491"><span class="mxinfo " id="T72:U492"><span class="mxinfo " id="T41:U493"><span class="var type1" id="S10T38U644">snake</span>.link</span>(<span class="mxinfo " id="T6:U495">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U496">trapz(<span class="mxinfo " id="T39:U497"><span class="var type1" id="S23T39U651">sqrtx</span>.*(<span class="mxinfo " id="T39:U499"><span class="mxinfo " id="T39:U500"><span class="mxinfo " id="T6:U501"><span class="var type1" id="S18T46U656">nu2</span>(<span class="mxinfo " id="T23:U503">2</span>)</span>*<span class="var type1" id="S20T39U658">x</span></span>+<span class="mxinfo " id="T39:U505"><span class="mxinfo " id="T6:U506"><span class="var type1" id="S18T46U661">nu2</span>(<span class="mxinfo " id="T23:U508">6</span>)</span>*<span class="mxinfo " id="T39:U509"><span class="var type1" id="S20T39U664">x</span>.^2</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,43" id="srcline43">43</a></span><span class="line">            <span class="mxinfo " id="T6:U511"><span class="mxinfo " id="T6:U512"><span class="var type1" id="S5T55U669">D</span>(<span class="mxinfo " id="T6:U514">6</span>,<span class="mxinfo " id="T6:U515">4</span>,<span class="mxinfo " id="T6:U516">1</span>)</span>=<span class="mxinfo " id="T6:U517"><span class="mxinfo " id="T6:U518"><span class="mxinfo " id="T6:U519"><span class="mxinfo " id="T6:U520"><span class="var type1" id="S27T6U677">rho</span>*<span class="mxinfo " id="T6:U522"><span class="var type1" id="S10T38U679">snake</span>.r</span></span>*<span class="mxinfo " id="T6:U524"><span class="mxinfo " id="T72:U525"><span class="mxinfo " id="T41:U526"><span class="var type1" id="S10T38U684">snake</span>.link</span>(<span class="mxinfo " id="T6:U528">1</span>)</span>.length</span></span>*<span class="var type1" id="S25T6U688">v_ref</span></span>*(<span class="mxinfo " id="T6:U530"><span class="mxinfo " id="T6:U531"><span class="mxinfo " id="T6:U532"><span class="mxinfo " id="T6:U533">0.5</span>*<span class="mxinfo " id="T6:U534"><span class="mxinfo " id="T72:U535"><span class="mxinfo " id="T41:U536"><span class="var type1" id="S10T38U697">snake</span>.link</span>(<span class="mxinfo " id="T6:U538">1</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U539"><span class="var type1" id="S18T46U702">nu2</span>(<span class="mxinfo " id="T6:U541">2</span>)</span></span>+<span class="mxinfo " id="T6:U542"><span class="mxinfo " id="T6:U543"><span class="mxinfo " id="T6:U544"><span class="mxinfo " id="T6:U545"><span class="var type1" id="S10T38U710">snake</span>.link(1).length</span>^2</span>*<span class="mxinfo " id="T6:U547"><span class="var type1" id="S18T46U716">nu2</span>(<span class="mxinfo " id="T23:U549">6</span>)</span></span>/<span class="mxinfo " id="T6:U550">3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,44" id="srcline44">44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,45" id="srcline45">45</a></span><span class="line">    <span class="mxinfo " id="T1:U551"><span class="var type1" id="S4T1U721">g</span>  = <span class="mxinfo " id="T1:U553"><span class="mxinfo " id="T79:U554"><span class="mxinfo " id="T79:U555"><span class="mxinfo " id="T58:U556"><span class="mxinfo " id="T59:U557"><span class="var type1" id="S7T54U727">J</span>(<span class="mxinfo " id="T60:U559">:</span>,<span class="mxinfo " id="T61:U560">:</span>,<span class="mxinfo " id="T23:U561">1</span>)</span>'</span>*<span class="mxinfo " id="T43:U562"><span class="var type1" id="S10T38U734">snake</span>.link(1).G</span></span>*<span class="mxinfo " id="T64:U564"><span class="mxinfo " id="T64:U565"><span class="var type1" id="S8T53U740">R</span>(<span class="mxinfo " id="T65:U567">:</span>,<span class="mxinfo " id="T65:U568">:</span>,<span class="mxinfo " id="T23:U569">1</span>)</span>'</span></span>*<span class="mxinfo " id="T48:U570"><span class="var type1" id="S11T47U745">pp</span>.gdir</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,46" id="srcline46">46</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,47" id="srcline47">47</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,48" id="srcline48">48</a></span><span class="line"> <span class="keyword">for</span> <span class="var type1" id="S34T6U749">i</span>=<span class="mxinfo " id="T50:U573"><span class="mxinfo " id="T6:U574">2</span>:<span class="var type1" id="S10T38U753">snake</span>.n</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,49" id="srcline49">49</a></span><span class="line">     <span class="mxinfo " id="T6:U576"><span class="var type1" id="S35T6U757">j</span>=<span class="mxinfo " id="T6:U578"><span class="var type1" id="S34T6U759">i</span>-<span class="mxinfo " id="T6:U580">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,50" id="srcline50">50</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T5:U581"><span class="mxinfo " id="T6:U582"><span class="mxinfo " id="T67:U583"><span class="mxinfo " id="T45:U584"><span class="var type1" id="S10T38U767">snake</span>.joint</span>(<span class="var type1" id="S35T6U769">j</span>)</span>.type</span>==<span class="mxinfo " id="T6:U587">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="78,51" id="srcline51">51</a></span><span class="line">        <span class="mxinfo " id="T68:U588"><span class="var type1" id="S36T68U774">A</span>=<span class="mxinfo " id="T68:U590">[<span class="mxinfo " id="T69:U591"><span class="mxinfo " id="T64:U592"><span class="fcn" id="F137N4:B778">Rotx</span>(<span class="mxinfo " id="T6:U593"><span class="var type1" id="S9T50U780">theta</span>(<span class="var type1" id="S35T6U781">j</span>)</span>)</span>, <span class="mxinfo " id="T70:U596"><span class="mxinfo " id="T71:U597">[<span class="mxinfo " id="T6:U598"><span class="mxinfo " id="T72:U599"><span class="mxinfo " id="T41:U600"><span class="var type1" id="S10T38U788">snake</span>.link</span>(<span class="var type1" id="S34T6U790">i</span>)</span>.length</span> <span class="mxinfo " id="T6:U603">0</span> <span class="mxinfo " id="T6:U604">0</span>]</span>'</span></span>; <span class="mxinfo " id="T73:U605">[<span class="mxinfo " id="T6:U606">0</span> <span class="mxinfo " id="T6:U607">0</span> <span class="mxinfo " id="T6:U608">0</span> <span class="mxinfo " id="T6:U609">1</span>]</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,52" id="srcline52">52</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo " id="T5:U610"><span class="mxinfo " id="T6:U611"><span class="mxinfo " id="T67:U612"><span class="mxinfo " id="T45:U613"><span class="var type1" id="S10T38U806">snake</span>.joint</span>(<span class="var type1" id="S35T6U808">j</span>)</span>.type</span>==<span class="mxinfo " id="T6:U616">2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="78,53" id="srcline53">53</a></span><span class="line">        <span class="mxinfo " id="T68:U617"><span class="var type1" id="S36T68U813">A</span>=<span class="mxinfo " id="T68:U619">[<span class="mxinfo " id="T69:U620"><span class="mxinfo " id="T64:U621"><span class="fcn" id="F144N5:B817">Roty</span>(<span class="mxinfo " id="T6:U622"><span class="var type1" id="S9T50U819">theta</span>(<span class="var type1" id="S35T6U820">j</span>)</span>)</span>, <span class="mxinfo " id="T70:U625"><span class="mxinfo " id="T71:U626">[<span class="mxinfo " id="T6:U627"><span class="mxinfo " id="T72:U628"><span class="mxinfo " id="T41:U629"><span class="var type1" id="S10T38U827">snake</span>.link</span>(<span class="var type1" id="S34T6U829">i</span>)</span>.length</span> <span class="mxinfo " id="T6:U632">0</span> <span class="mxinfo " id="T6:U633">0</span>]</span>'</span></span>; <span class="mxinfo " id="T73:U634">[<span class="mxinfo " id="T6:U635">0</span> <span class="mxinfo " id="T6:U636">0</span> <span class="mxinfo " id="T6:U637">0</span> <span class="mxinfo " id="T6:U638">1</span>]</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,54" id="srcline54">54</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,55" id="srcline55">55</a></span><span class="line">        <span class="mxinfo " id="T68:U639"><span class="var type1" id="S36T68U843">A</span>=<span class="mxinfo " id="T68:U641">[<span class="mxinfo " id="T69:U642"><span class="mxinfo " id="T64:U643"><span class="fcn" id="F145N6:B847">Rotz</span>(<span class="mxinfo " id="T6:U644"><span class="var type1" id="S9T50U849">theta</span>(<span class="var type1" id="S35T6U850">j</span>)</span>)</span>, <span class="mxinfo " id="T70:U647"><span class="mxinfo " id="T71:U648">[<span class="mxinfo " id="T6:U649"><span class="mxinfo " id="T72:U650"><span class="mxinfo " id="T41:U651"><span class="var type1" id="S10T38U857">snake</span>.link</span>(<span class="var type1" id="S34T6U859">i</span>)</span>.length</span> <span class="mxinfo " id="T6:U654">0</span> <span class="mxinfo " id="T6:U655">0</span>]</span>'</span></span>; <span class="mxinfo " id="T73:U656">[<span class="mxinfo " id="T6:U657">0</span> <span class="mxinfo " id="T6:U658">0</span> <span class="mxinfo " id="T6:U659">0</span> <span class="mxinfo " id="T6:U660">1</span>]</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,56" id="srcline56">56</a></span><span class="line">    <span class="keyword">end</span>           </span></span>
<span class="srcline"><span class="lineno"><a href="78,57" id="srcline57">57</a></span><span class="line">     <span class="mxinfo " id="T46:U661"><span class="var type1" id="S40T46U872">twist</span>    = <span class="mxinfo " id="T46:U663"><span class="mxinfo " id="T67:U664"><span class="mxinfo " id="T45:U665"><span class="var type1" id="S10T38U876">snake</span>.joint</span>(<span class="var type1" id="S35T6U878">j</span>)</span>.twist</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="78,58" id="srcline58">58</a></span><span class="line">     <span class="mxinfo " id="T42:U668"><span class="var type1" id="S41T42U882">Adinv</span>    = <span class="mxinfo " id="T42:U670"><span class="fcn" id="F146N2:B884">Ad_inv</span>(<span class="var type1" id="S36T68U885">A</span>)</span></span>;                       </span></span>
<span class="srcline"><span class="lineno"><a href="78,59" id="srcline59">59</a></span><span class="line">     <span class="mxinfo " id="T42:U672"><span class="var type1" id="S43T42U888">ad_tw</span>    = <span class="mxinfo " id="T42:U674"><span class="fcn" id="F249N8:B890">ad</span>(<span class="var type1" id="S40T46U891">twist</span>)</span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="78,60" id="srcline60">60</a></span><span class="line">     <span class="mxinfo " id="T46:U676"><span class="var type1" id="S17T46U894">nu1</span>      = <span class="mxinfo " id="T46:U678"><span class="mxinfo " id="T46:U679"><span class="var type1" id="S41T42U897">Adinv</span>*<span class="var type1" id="S17T46U898">nu1</span></span> + <span class="mxinfo " id="T46:U682"><span class="var type1" id="S40T46U900">twist</span>*<span class="mxinfo " id="T6:U684"><span class="var type1" id="S14T1U902">zeta1</span>(<span class="mxinfo " id="T6:U686"><span class="mxinfo " id="T6:U687">6</span>+<span class="var type1" id="S35T6U905">j</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,61" id="srcline61">61</a></span><span class="line">     <span class="mxinfo " id="T46:U689"><span class="var type1" id="S18T46U908">nu2</span>      = <span class="mxinfo " id="T46:U691"><span class="mxinfo " id="T46:U692"><span class="var type1" id="S41T42U911">Adinv</span>*<span class="var type1" id="S18T46U912">nu2</span></span> + <span class="mxinfo " id="T46:U695"><span class="var type1" id="S40T46U914">twist</span>*<span class="mxinfo " id="T6:U697"><span class="var type1" id="S15T1U916">zeta_r</span>(<span class="mxinfo " id="T6:U699"><span class="mxinfo " id="T6:U700">6</span>+<span class="var type1" id="S35T6U919">j</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,62" id="srcline62">62</a></span><span class="line">     <span class="mxinfo " id="T46:U702"><span class="var type1" id="S29T46U922">xi</span>       = <span class="mxinfo " id="T46:U704"><span class="mxinfo " id="T46:U705"><span class="mxinfo " id="T42:U706"><span class="mxinfo " id="T42:U707">-<span class="var type1" id="S43T42U927">ad_tw</span></span>*<span class="mxinfo " id="T6:U709"><span class="var type1" id="S14T1U929">zeta1</span>(<span class="mxinfo " id="T6:U711"><span class="mxinfo " id="T6:U712">6</span>+<span class="var type1" id="S35T6U932">j</span></span>)</span></span>*<span class="var type1" id="S18T46U933">nu2</span></span> + <span class="mxinfo " id="T46:U715"><span class="var type1" id="S41T42U935">Adinv</span>*<span class="var type1" id="S29T46U936">xi</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,63" id="srcline63">63</a></span><span class="line">     <span class="mxinfo " id="T42:U718"><span class="var type1" id="S45T42U939">M</span>        = <span class="mxinfo " id="T42:U720"><span class="mxinfo " id="T72:U721"><span class="mxinfo " id="T41:U722"><span class="var type1" id="S10T38U943">snake</span>.link</span>(<span class="var type1" id="S34T6U945">i</span>)</span>.M</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,64" id="srcline64">64</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="78,65" id="srcline65">65</a></span><span class="line">     <span class="mxinfo " id="T1:U725"><span class="var type1" id="S2T1U949">c</span>        = <span class="mxinfo " id="T1:U727"><span class="var type1" id="S2T1U951">c</span> + <span class="mxinfo " id="T1:U729"><span class="mxinfo " id="T58:U730"><span class="mxinfo " id="T59:U731"><span class="var type1" id="S7T54U955">J</span>(<span class="mxinfo " id="T60:U733">:</span>,<span class="mxinfo " id="T61:U734">:</span>,<span class="var type1" id="S34T6U958">i</span>)</span>'</span>*(<span class="mxinfo " id="T46:U736"><span class="mxinfo " id="T46:U737"><span class="var type1" id="S45T42U962">M</span>*<span class="var type1" id="S29T46U963">xi</span></span> - <span class="mxinfo " id="T46:U740"><span class="mxinfo " id="T42:U741"><span class="fcn" id="F204N7:B966">W</span>(<span class="mxinfo " id="T46:U742"><span class="var type1" id="S45T42U968">M</span>*<span class="var type1" id="S17T46U969">nu1</span></span>)</span>*<span class="var type1" id="S18T46U970">nu2</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,66" id="srcline66">66</a></span><span class="line">     <span class="keyword">if</span> <span class="mxinfo " id="T5:U746"><span class="mxinfo " id="T6:U747"><span class="mxinfo " id="T72:U748"><span class="mxinfo " id="T41:U749"><span class="var type1" id="S10T38U977">snake</span>.link</span>(<span class="var type1" id="S34T6U979">i</span>)</span>.dragtype</span>==<span class="mxinfo " id="T6:U752">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="78,67" id="srcline67">67</a></span><span class="line">          <span class="mxinfo " id="T1:U753"><span class="var type1" id="S3T1U984">d</span>   = <span class="mxinfo " id="T1:U755"><span class="var type1" id="S3T1U986">d</span> + <span class="mxinfo " id="T1:U757"><span class="mxinfo " id="T58:U758"><span class="mxinfo " id="T59:U759"><span class="var type1" id="S7T54U990">J</span>(<span class="mxinfo " id="T60:U761">:</span>,<span class="mxinfo " id="T61:U762">:</span>,<span class="var type1" id="S34T6U993">i</span>)</span>'</span>*<span class="mxinfo " id="T46:U764">zeros(<span class="mxinfo " id="T6:U765">6</span>,1)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,68" id="srcline68">68</a></span><span class="line">          <span class="mxinfo " id="T62:U766"><span class="mxinfo " id="T62:U767"><span class="var type1" id="S5T55U1001">D</span>(<span class="mxinfo " id="T60:U769">:</span>,<span class="mxinfo " id="T63:U770">:</span>,<span class="var type1" id="S34T6U1004">i</span>)</span>=<span class="mxinfo " id="T62:U772">zeros(<span class="mxinfo " id="T6:U773">6</span>,<span class="mxinfo " id="T6:U774">4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,69" id="srcline69">69</a></span><span class="line">     <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,70" id="srcline70">70</a></span><span class="line">          <span class="mxinfo " id="T1:U775"><span class="var type1" id="S3T1U1012">d</span>   = <span class="mxinfo " id="T1:U777"><span class="var type1" id="S3T1U1014">d</span> + <span class="mxinfo " id="T1:U779"><span class="mxinfo " id="T58:U780"><span class="mxinfo " id="T59:U781"><span class="var type1" id="S7T54U1018">J</span>(<span class="mxinfo " id="T60:U783">:</span>,<span class="mxinfo " id="T61:U784">:</span>,<span class="var type1" id="S34T6U1021">i</span>)</span>'</span>*<span class="mxinfo " id="T46:U786"><span class="fcn" id="F212N13:B1023">drag</span>(<span class="var type1" id="S17T46U1024">nu1</span>,<span class="var type1" id="S18T46U1025">nu2</span>,<span class="mxinfo " id="T6:U789"><span class="mxinfo " id="T72:U790"><span class="mxinfo " id="T41:U791"><span class="var type1" id="S10T38U1029">snake</span>.link</span>(<span class="var type1" id="S34T6U1031">i</span>)</span>.length</span>,<span class="mxinfo " id="T6:U794"><span class="var type1" id="S11T47U1034">pp</span>.denw</span>,<span class="mxinfo " id="T6:U796"><span class="var type1" id="S10T38U1037">snake</span>.r</span>,<span class="var type1" id="S16T66U1039">dragcoeff_for_comparison</span>)</span></span></span></span>;  <span class="comment">%Sjekk om det er riktig å ha i her</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,71" id="srcline71">71</a></span><span class="line">          <span class="mxinfo " id="T6:U799"><span class="mxinfo " id="T6:U800"><span class="var type1" id="S5T55U1043">D</span>(<span class="mxinfo " id="T6:U802">1</span>,<span class="mxinfo " id="T6:U803">1</span>,<span class="var type1" id="S34T6U1046">i</span>)</span>=<span class="mxinfo " id="T6:U805"><span class="mxinfo " id="T6:U806"><span class="mxinfo " id="T6:U807"><span class="mxinfo " id="T6:U808"><span class="mxinfo " id="T6:U809"><span class="mxinfo " id="T6:U810">.5</span>*<span class="var type1" id="S27T6U1053">rho</span></span>*<span class="mxinfo " id="T6:U812">pi</span></span>*<span class="mxinfo " id="T6:U813"><span class="mxinfo " id="T6:U814"><span class="var type1" id="S10T38U1058">snake</span>.r</span>^2</span></span>*<span class="mxinfo " id="T6:U816">abs(<span class="mxinfo " id="T6:U817"><span class="var type1" id="S17T46U1064">nu1</span>(<span class="mxinfo " id="T23:U819">1</span>)</span>)</span></span>*<span class="mxinfo " id="T6:U820"><span class="var type1" id="S18T46U1067">nu2</span>(<span class="mxinfo " id="T6:U822">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,72" id="srcline72">72</a></span><span class="line">            <span class="mxinfo " id="T6:U823"><span class="mxinfo " id="T6:U824"><span class="var type1" id="S5T55U1072">D</span>(<span class="mxinfo " id="T6:U826">1</span>,<span class="mxinfo " id="T6:U827">4</span>,<span class="var type1" id="S34T6U1075">i</span>)</span>=<span class="mxinfo " id="T6:U829"><span class="mxinfo " id="T6:U830"><span class="mxinfo " id="T6:U831"><span class="mxinfo " id="T6:U832"><span class="mxinfo " id="T6:U833"><span class="var type1" id="S27T6U1081">rho</span>*<span class="mxinfo " id="T6:U835"><span class="var type1" id="S10T38U1083">snake</span>.r</span></span>*<span class="mxinfo " id="T6:U837"><span class="mxinfo " id="T72:U838"><span class="mxinfo " id="T41:U839"><span class="var type1" id="S10T38U1088">snake</span>.link</span>(<span class="var type1" id="S34T6U1090">i</span>)</span>.length</span></span>*<span class="var type1" id="S25T6U1092">v_ref</span></span>*<span class="var type1" id="S12T6U1093">beta</span></span>*<span class="mxinfo " id="T6:U844"><span class="var type1" id="S18T46U1095">nu2</span>(<span class="mxinfo " id="T6:U846">1</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,73" id="srcline73">73</a></span><span class="line">            <span class="mxinfo " id="T6:U847"><span class="mxinfo " id="T6:U848"><span class="var type1" id="S5T55U1100">D</span>(<span class="mxinfo " id="T6:U850">2</span>,<span class="mxinfo " id="T6:U851">3</span>,<span class="var type1" id="S34T6U1103">i</span>)</span>=<span class="mxinfo " id="T6:U853"><span class="mxinfo " id="T6:U854"><span class="mxinfo " id="T6:U855"><span class="mxinfo " id="T6:U856"><span class="var type1" id="S27T6U1108">rho</span>*<span class="mxinfo " id="T6:U858"><span class="var type1" id="S10T38U1110">snake</span>.r</span></span>*<span class="var type1" id="S22T6U1112">dx</span></span>*<span class="mxinfo " id="T6:U861"><span class="mxinfo " id="T72:U862"><span class="mxinfo " id="T41:U863"><span class="var type1" id="S10T38U1116">snake</span>.link</span>(<span class="var type1" id="S34T6U1118">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U866">trapz(<span class="mxinfo " id="T39:U867"><span class="var type1" id="S23T39U1123">sqrtx</span>.*(<span class="mxinfo " id="T39:U869"><span class="mxinfo " id="T6:U870"><span class="var type1" id="S18T46U1127">nu2</span>(<span class="mxinfo " id="T6:U872">2</span>)</span>+<span class="mxinfo " id="T39:U873"><span class="mxinfo " id="T6:U874"><span class="var type1" id="S18T46U1131">nu2</span>(<span class="mxinfo " id="T23:U876">6</span>)</span>*<span class="var type1" id="S20T39U1133">x</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,74" id="srcline74">74</a></span><span class="line">            <span class="mxinfo " id="T6:U878"><span class="mxinfo " id="T6:U879"><span class="var type1" id="S5T55U1137">D</span>(<span class="mxinfo " id="T6:U881">2</span>,<span class="mxinfo " id="T6:U882">4</span>,<span class="var type1" id="S34T6U1140">i</span>)</span>=<span class="mxinfo " id="T6:U884"><span class="mxinfo " id="T6:U885"><span class="mxinfo " id="T6:U886"><span class="mxinfo " id="T6:U887"><span class="var type1" id="S27T6U1145">rho</span>*<span class="mxinfo " id="T6:U889"><span class="var type1" id="S10T38U1147">snake</span>.r</span></span>*<span class="mxinfo " id="T6:U891"><span class="mxinfo " id="T72:U892"><span class="mxinfo " id="T41:U893"><span class="var type1" id="S10T38U1152">snake</span>.link</span>(<span class="var type1" id="S34T6U1154">i</span>)</span>.length</span></span>*<span class="var type1" id="S25T6U1156">v_ref</span></span>*(<span class="mxinfo " id="T6:U897"><span class="mxinfo " id="T6:U898"><span class="var type1" id="S18T46U1160">nu2</span>(<span class="mxinfo " id="T6:U900">2</span>)</span>+<span class="mxinfo " id="T6:U901"><span class="mxinfo " id="T6:U902"><span class="mxinfo " id="T6:U903">0.5</span>*<span class="mxinfo " id="T6:U904"><span class="mxinfo " id="T72:U905"><span class="mxinfo " id="T41:U906"><span class="var type1" id="S10T38U1168">snake</span>.link</span>(<span class="var type1" id="S34T6U1170">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U909"><span class="var type1" id="S18T46U1173">nu2</span>(<span class="mxinfo " id="T6:U911">6</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,75" id="srcline75">75</a></span><span class="line">            <span class="mxinfo " id="T6:U912"><span class="mxinfo " id="T6:U913"><span class="var type1" id="S5T55U1178">D</span>(<span class="mxinfo " id="T6:U915">3</span>,<span class="mxinfo " id="T6:U916">3</span>,<span class="var type1" id="S34T6U1181">i</span>)</span>=<span class="mxinfo " id="T6:U918"><span class="mxinfo " id="T6:U919"><span class="mxinfo " id="T6:U920"><span class="mxinfo " id="T6:U921"><span class="var type1" id="S27T6U1186">rho</span>*<span class="mxinfo " id="T6:U923"><span class="var type1" id="S10T38U1188">snake</span>.r</span></span>*<span class="var type1" id="S22T6U1190">dx</span></span>*<span class="mxinfo " id="T6:U926"><span class="mxinfo " id="T72:U927"><span class="mxinfo " id="T41:U928"><span class="var type1" id="S10T38U1194">snake</span>.link</span>(<span class="var type1" id="S34T6U1196">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U931">trapz(<span class="mxinfo " id="T39:U932"><span class="var type1" id="S23T39U1201">sqrtx</span>.*(<span class="mxinfo " id="T39:U934"><span class="mxinfo " id="T6:U935"><span class="var type1" id="S18T46U1205">nu2</span>(<span class="mxinfo " id="T6:U937">3</span>)</span>-<span class="mxinfo " id="T39:U938"><span class="mxinfo " id="T6:U939"><span class="var type1" id="S18T46U1209">nu2</span>(<span class="mxinfo " id="T23:U941">5</span>)</span>*<span class="var type1" id="S20T39U1211">x</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,76" id="srcline76">76</a></span><span class="line">            <span class="mxinfo " id="T6:U943"><span class="mxinfo " id="T6:U944"><span class="var type1" id="S5T55U1215">D</span>(<span class="mxinfo " id="T6:U946">3</span>,<span class="mxinfo " id="T6:U947">4</span>,<span class="var type1" id="S34T6U1218">i</span>)</span>=<span class="mxinfo " id="T6:U949"><span class="mxinfo " id="T6:U950"><span class="mxinfo " id="T6:U951"><span class="mxinfo " id="T6:U952"><span class="var type1" id="S27T6U1223">rho</span>*<span class="mxinfo " id="T6:U954"><span class="var type1" id="S10T38U1225">snake</span>.r</span></span>*<span class="mxinfo " id="T6:U956"><span class="mxinfo " id="T72:U957"><span class="mxinfo " id="T41:U958"><span class="var type1" id="S10T38U1230">snake</span>.link</span>(<span class="var type1" id="S34T6U1232">i</span>)</span>.length</span></span>*<span class="var type1" id="S25T6U1234">v_ref</span></span>*(<span class="mxinfo " id="T6:U962"><span class="mxinfo " id="T6:U963"><span class="var type1" id="S18T46U1238">nu2</span>(<span class="mxinfo " id="T6:U965">3</span>)</span>-<span class="mxinfo " id="T6:U966"><span class="mxinfo " id="T6:U967"><span class="mxinfo " id="T6:U968">0.5</span>*<span class="mxinfo " id="T6:U969"><span class="mxinfo " id="T72:U970"><span class="mxinfo " id="T41:U971"><span class="var type1" id="S10T38U1246">snake</span>.link</span>(<span class="var type1" id="S34T6U1248">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U974"><span class="var type1" id="S18T46U1251">nu2</span>(<span class="mxinfo " id="T6:U976">5</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,77" id="srcline77">77</a></span><span class="line">            <span class="mxinfo " id="T6:U977"><span class="mxinfo " id="T6:U978"><span class="var type1" id="S5T55U1256">D</span>(<span class="mxinfo " id="T6:U980">4</span>,<span class="mxinfo " id="T6:U981">2</span>,<span class="var type1" id="S34T6U1259">i</span>)</span>=<span class="mxinfo " id="T6:U983"><span class="mxinfo " id="T6:U984"><span class="mxinfo " id="T6:U985"><span class="mxinfo " id="T6:U986"><span class="mxinfo " id="T6:U987"><span class="mxinfo " id="T6:U988"><span class="mxinfo " id="T6:U989">.5</span>*<span class="var type1" id="S27T6U1267">rho</span></span>*<span class="mxinfo " id="T6:U991">pi</span></span>*<span class="mxinfo " id="T6:U992"><span class="mxinfo " id="T72:U993"><span class="mxinfo " id="T41:U994"><span class="var type1" id="S10T38U1273">snake</span>.link</span>(<span class="var type1" id="S34T6U1275">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U997"><span class="mxinfo " id="T6:U998"><span class="var type1" id="S10T38U1279">snake</span>.r</span>^4</span></span>*<span class="mxinfo " id="T6:U1000">abs(<span class="mxinfo " id="T6:U1001"><span class="var type1" id="S17T46U1285">nu1</span>(<span class="mxinfo " id="T23:U1003">4</span>)</span>)</span></span>*<span class="mxinfo " id="T6:U1004"><span class="var type1" id="S18T46U1288">nu2</span>(<span class="mxinfo " id="T6:U1006">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,78" id="srcline78">78</a></span><span class="line">            <span class="mxinfo " id="T6:U1007"><span class="mxinfo " id="T6:U1008"><span class="var type1" id="S5T55U1293">D</span>(<span class="mxinfo " id="T6:U1010">4</span>,<span class="mxinfo " id="T6:U1011">4</span>,<span class="var type1" id="S34T6U1296">i</span>)</span>=<span class="mxinfo " id="T6:U1013"><span class="mxinfo " id="T6:U1014"><span class="mxinfo " id="T6:U1015"><span class="mxinfo " id="T6:U1016"><span class="mxinfo " id="T6:U1017"><span class="mxinfo " id="T6:U1018"><span class="var type1" id="S27T6U1303">rho</span>*<span class="mxinfo " id="T6:U1020"><span class="var type1" id="S10T38U1305">snake</span>.r</span></span>*<span class="mxinfo " id="T6:U1022"><span class="mxinfo " id="T72:U1023"><span class="mxinfo " id="T41:U1024"><span class="var type1" id="S10T38U1310">snake</span>.link</span>(<span class="var type1" id="S34T6U1312">i</span>)</span>.length</span></span>*<span class="var type1" id="S25T6U1314">v_ref</span></span>*<span class="var type1" id="S13T6U1315">gamma</span></span>*<span class="mxinfo " id="T6:U1029"><span class="mxinfo " id="T6:U1030"><span class="var type1" id="S10T38U1318">snake</span>.r</span>^2</span></span>*<span class="mxinfo " id="T6:U1032"><span class="var type1" id="S18T46U1322">nu2</span>(<span class="mxinfo " id="T6:U1034">4</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,79" id="srcline79">79</a></span><span class="line">            <span class="mxinfo " id="T6:U1035"><span class="mxinfo " id="T6:U1036"><span class="var type1" id="S5T55U1327">D</span>(<span class="mxinfo " id="T6:U1038">5</span>,<span class="mxinfo " id="T6:U1039">3</span>,<span class="var type1" id="S34T6U1330">i</span>)</span>=<span class="mxinfo " id="T6:U1041"><span class="mxinfo " id="T6:U1042"><span class="mxinfo " id="T6:U1043"><span class="mxinfo " id="T6:U1044"><span class="var type1" id="S27T6U1335">rho</span>*<span class="mxinfo " id="T6:U1046"><span class="var type1" id="S10T38U1337">snake</span>.r</span></span>*<span class="var type1" id="S22T6U1339">dx</span></span>*<span class="mxinfo " id="T6:U1049"><span class="mxinfo " id="T72:U1050"><span class="mxinfo " id="T41:U1051"><span class="var type1" id="S10T38U1343">snake</span>.link</span>(<span class="var type1" id="S34T6U1345">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U1054">trapz(<span class="mxinfo " id="T39:U1055"><span class="var type1" id="S23T39U1350">sqrtx</span>.*(<span class="mxinfo " id="T39:U1057"><span class="mxinfo " id="T39:U1058"><span class="mxinfo " id="T6:U1059">-<span class="mxinfo " id="T6:U1060"><span class="var type1" id="S18T46U1356">nu2</span>(<span class="mxinfo " id="T23:U1062">3</span>)</span></span>*<span class="var type1" id="S20T39U1358">x</span></span>+<span class="mxinfo " id="T39:U1064"><span class="mxinfo " id="T6:U1065"><span class="var type1" id="S18T46U1361">nu2</span>(<span class="mxinfo " id="T23:U1067">5</span>)</span>*<span class="mxinfo " id="T39:U1068"><span class="var type1" id="S20T39U1364">x</span>.^2</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,80" id="srcline80">80</a></span><span class="line">            <span class="mxinfo " id="T6:U1070"><span class="mxinfo " id="T6:U1071"><span class="var type1" id="S5T55U1369">D</span>(<span class="mxinfo " id="T6:U1073">5</span>,<span class="mxinfo " id="T6:U1074">4</span>,<span class="var type1" id="S34T6U1372">i</span>)</span>=<span class="mxinfo " id="T6:U1076"><span class="mxinfo " id="T6:U1077"><span class="mxinfo " id="T6:U1078"><span class="mxinfo " id="T6:U1079"><span class="var type1" id="S27T6U1377">rho</span>*<span class="mxinfo " id="T6:U1081"><span class="var type1" id="S10T38U1379">snake</span>.r</span></span>*<span class="mxinfo " id="T6:U1083"><span class="mxinfo " id="T72:U1084"><span class="mxinfo " id="T41:U1085"><span class="var type1" id="S10T38U1384">snake</span>.link</span>(<span class="var type1" id="S34T6U1386">i</span>)</span>.length</span></span>*<span class="var type1" id="S25T6U1388">v_ref</span></span>*(<span class="mxinfo " id="T6:U1089"><span class="mxinfo " id="T6:U1090"><span class="mxinfo " id="T6:U1091"><span class="mxinfo " id="T6:U1092">-<span class="mxinfo " id="T6:U1093">0.5</span></span>*<span class="mxinfo " id="T6:U1094"><span class="mxinfo " id="T72:U1095"><span class="mxinfo " id="T41:U1096"><span class="var type1" id="S10T38U1398">snake</span>.link</span>(<span class="var type1" id="S34T6U1400">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U1099"><span class="var type1" id="S18T46U1403">nu2</span>(<span class="mxinfo " id="T6:U1101">3</span>)</span></span>+<span class="mxinfo " id="T6:U1102"><span class="mxinfo " id="T6:U1103"><span class="mxinfo " id="T6:U1104"><span class="mxinfo " id="T6:U1105"><span class="mxinfo " id="T72:U1106"><span class="mxinfo " id="T41:U1107"><span class="var type1" id="S10T38U1411">snake</span>.link</span>(<span class="var type1" id="S34T6U1413">i</span>)</span>.length</span>^2</span>*<span class="mxinfo " id="T6:U1110"><span class="var type1" id="S18T46U1417">nu2</span>(<span class="mxinfo " id="T6:U1112">5</span>)</span></span>/<span class="mxinfo " id="T6:U1113">3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,81" id="srcline81">81</a></span><span class="line">            <span class="mxinfo " id="T6:U1114"><span class="mxinfo " id="T6:U1115"><span class="var type1" id="S5T55U1423">D</span>(<span class="mxinfo " id="T6:U1117">6</span>,<span class="mxinfo " id="T6:U1118">3</span>,<span class="var type1" id="S34T6U1426">i</span>)</span>=<span class="mxinfo " id="T6:U1120"><span class="mxinfo " id="T6:U1121"><span class="mxinfo " id="T6:U1122"><span class="mxinfo " id="T6:U1123"><span class="var type1" id="S27T6U1431">rho</span>*<span class="mxinfo " id="T6:U1125"><span class="var type1" id="S10T38U1433">snake</span>.r</span></span>*<span class="var type1" id="S22T6U1435">dx</span></span>*<span class="mxinfo " id="T6:U1128"><span class="mxinfo " id="T72:U1129"><span class="mxinfo " id="T41:U1130"><span class="var type1" id="S10T38U1439">snake</span>.link</span>(<span class="var type1" id="S34T6U1441">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U1133">trapz(<span class="mxinfo " id="T39:U1134"><span class="var type1" id="S23T39U1446">sqrtx</span>.*(<span class="mxinfo " id="T39:U1136"><span class="mxinfo " id="T39:U1137"><span class="mxinfo " id="T6:U1138"><span class="var type1" id="S18T46U1451">nu2</span>(<span class="mxinfo " id="T23:U1140">2</span>)</span>*<span class="var type1" id="S20T39U1453">x</span></span>+<span class="mxinfo " id="T39:U1142"><span class="mxinfo " id="T6:U1143"><span class="var type1" id="S18T46U1456">nu2</span>(<span class="mxinfo " id="T23:U1145">6</span>)</span>*<span class="mxinfo " id="T39:U1146"><span class="var type1" id="S20T39U1459">x</span>.^2</span></span></span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,82" id="srcline82">82</a></span><span class="line">            <span class="mxinfo " id="T6:U1148"><span class="mxinfo " id="T6:U1149"><span class="var type1" id="S5T55U1464">D</span>(<span class="mxinfo " id="T6:U1151">6</span>,<span class="mxinfo " id="T6:U1152">4</span>,<span class="var type1" id="S34T6U1467">i</span>)</span>=<span class="mxinfo " id="T6:U1154"><span class="mxinfo " id="T6:U1155"><span class="mxinfo " id="T6:U1156"><span class="mxinfo " id="T6:U1157"><span class="var type1" id="S27T6U1472">rho</span>*<span class="mxinfo " id="T6:U1159"><span class="var type1" id="S10T38U1474">snake</span>.r</span></span>*<span class="mxinfo " id="T6:U1161"><span class="mxinfo " id="T72:U1162"><span class="mxinfo " id="T41:U1163"><span class="var type1" id="S10T38U1479">snake</span>.link</span>(<span class="var type1" id="S34T6U1481">i</span>)</span>.length</span></span>*<span class="var type1" id="S25T6U1483">v_ref</span></span>*(<span class="mxinfo " id="T6:U1167"><span class="mxinfo " id="T6:U1168"><span class="mxinfo " id="T6:U1169"><span class="mxinfo " id="T6:U1170">0.5</span>*<span class="mxinfo " id="T6:U1171"><span class="mxinfo " id="T72:U1172"><span class="mxinfo " id="T41:U1173"><span class="var type1" id="S10T38U1492">snake</span>.link</span>(<span class="var type1" id="S34T6U1494">i</span>)</span>.length</span></span>*<span class="mxinfo " id="T6:U1176"><span class="var type1" id="S18T46U1497">nu2</span>(<span class="mxinfo " id="T6:U1178">2</span>)</span></span>+<span class="mxinfo " id="T6:U1179"><span class="mxinfo " id="T6:U1180"><span class="mxinfo " id="T6:U1181"><span class="mxinfo " id="T6:U1182"><span class="mxinfo " id="T72:U1183"><span class="mxinfo " id="T41:U1184"><span class="var type1" id="S10T38U1505">snake</span>.link</span>(<span class="var type1" id="S34T6U1507">i</span>)</span>.length</span>^2</span>*<span class="mxinfo " id="T6:U1187"><span class="var type1" id="S18T46U1511">nu2</span>(<span class="mxinfo " id="T6:U1189">6</span>)</span></span>/<span class="mxinfo " id="T6:U1190">3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,83" id="srcline83">83</a></span><span class="line">          </span></span>
<span class="srcline"><span class="lineno"><a href="78,84" id="srcline84">84</a></span><span class="line">     <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,85" id="srcline85">85</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="78,86" id="srcline86">86</a></span><span class="line">          <span class="mxinfo " id="T1:U1191"><span class="var type1" id="S4T1U1516">g</span>   = <span class="mxinfo " id="T1:U1193"><span class="var type1" id="S4T1U1518">g</span> + <span class="mxinfo " id="T1:U1195"><span class="mxinfo " id="T79:U1196"><span class="mxinfo " id="T79:U1197"><span class="mxinfo " id="T58:U1198"><span class="mxinfo " id="T59:U1199"><span class="var type1" id="S7T54U1524">J</span>(<span class="mxinfo " id="T60:U1201">:</span>,<span class="mxinfo " id="T61:U1202">:</span>,<span class="var type1" id="S34T6U1527">i</span>)</span>'</span>*<span class="mxinfo " id="T43:U1204"><span class="mxinfo " id="T72:U1205"><span class="mxinfo " id="T41:U1206"><span class="var type1" id="S10T38U1531">snake</span>.link</span>(<span class="var type1" id="S34T6U1533">i</span>)</span>.G</span></span>*<span class="mxinfo " id="T64:U1209"><span class="mxinfo " id="T64:U1210"><span class="var type1" id="S8T53U1537">R</span>(<span class="mxinfo " id="T65:U1212">:</span>,<span class="mxinfo " id="T65:U1213">:</span>,<span class="var type1" id="S34T6U1540">i</span>)</span>'</span></span>*<span class="mxinfo " id="T48:U1215"><span class="var type1" id="S11T47U1542">pp</span>.gdir</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="78,87" id="srcline87">87</a></span><span class="line"> <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="78,88" id="srcline88">88</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
